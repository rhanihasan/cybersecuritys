"use strict";(self.webpackChunkhassan_website=self.webpackChunkhassan_website||[]).push([[6341],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>k});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),p=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(o.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,k=d["".concat(o,".").concat(c)]||d[c]||u[c]||s;return n?a.createElement(k,i(i({ref:t},m),{},{components:n})):a.createElement(k,i({ref:t},m))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=c;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<s;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7477:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const s={sidebar_position:10},i="Network Service Enumeration",l={unversionedId:"CyberSecurity/CyberrSecurity360/Network Service Enumeration",id:"CyberSecurity/CyberrSecurity360/Network Service Enumeration",title:"Network Service Enumeration",description:"---",source:"@site/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration.md",sourceDirName:"CyberSecurity/CyberrSecurity360",slug:"/CyberSecurity/CyberrSecurity360/Network Service Enumeration",permalink:"/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration",draft:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"The Craft of Network Scanning",permalink:"/journey/docs/CyberSecurity/CyberrSecurity360/The Craft of Network Scanning"},next:{title:"Palo Alto Introduction",permalink:"/journey/docs/CyberSecurity/Palo Alto/Palo Alto Introduction"}},o={},p=[{value:"Enumeration",id:"enumeration",level:2},{value:"What &amp; Why Enumeration?",id:"what--why-enumeration",level:3},{value:"Services",id:"services",level:2},{value:"What &amp; Why Service?",id:"what--why-service",level:3},{value:"Service Enumeration",id:"service-enumeration",level:2},{value:"What &amp; Why Service Enumeration?",id:"what--why-service-enumeration",level:3},{value:"SMB Service",id:"smb-service",level:2},{value:"What &amp; Why SMB?",id:"what--why-smb",level:3},{value:"What does port 139 do?",id:"what-does-port-139-do",level:3},{value:"What does NetBIOS do?",id:"what-does-netbios-do",level:3},{value:"Port 445",id:"port-445",level:3},{value:"IPC$ Share",id:"ipc-share",level:3},{value:"SMB Protocol",id:"smb-protocol",level:3},{value:"Client-Server Connection",id:"client-server-connection",level:3},{value:"Enumerating NetBIOS",id:"enumerating-netbios",level:3},{value:"Possible Credentials",id:"possible-credentials",level:3},{value:"Identification &amp; Scan",id:"identification--scan",level:2},{value:"SMB Communication via Wireshark",id:"smb-communication-via-wireshark",level:3},{value:"nblookup",id:"nblookup",level:2},{value:"nbstate",id:"nbstate",level:2},{value:"nbtscan",id:"nbtscan",level:2},{value:"Syntax &amp; Commands",id:"syntax--commands",level:3},{value:"Communication between Two Windows PCs",id:"communication-between-two-windows-pcs",level:2},{value:"Syntax &amp; Commands",id:"syntax--commands-1",level:3},{value:"SMB Login with Credentials &amp; Hashes",id:"smb-login-with-credentials--hashes",level:2},{value:"Syntax &amp; Commands for Credentials",id:"syntax--commands-for-credentials",level:3},{value:"Syntax &amp; Commands for Hashes",id:"syntax--commands-for-hashes",level:3},{value:"Accessing Shares using smbclient",id:"accessing-shares-using-smbclient",level:3},{value:"Nmap Scan",id:"nmap-scan",level:2},{value:"Syntax &amp; Commands",id:"syntax--commands-2",level:3},{value:"SMB Enumeration",id:"smb-enumeration",level:2},{value:"NSE Nmap",id:"nse-nmap",level:3},{value:"Syntax &amp; Commands For SMB V1",id:"syntax--commands-for-smb-v1",level:4},{value:"Windows",id:"windows",level:4},{value:"BeeBox",id:"beebox",level:4},{value:"SMB Enumeration Using SMBv2 Scripts",id:"smb-enumeration-using-smbv2-scripts",level:2},{value:"Syntax &amp; Commands",id:"syntax--commands-3",level:3},{value:"Output Examples",id:"output-examples",level:3},{value:"Output (Linux):",id:"output-linux",level:4},{value:"Output (Windows):",id:"output-windows",level:4},{value:"Enumeration Insights",id:"enumeration-insights",level:3},{value:"Guest Sessions Enumeration",id:"guest-sessions-enumeration",level:2},{value:"What are Guest Sessions?",id:"what-are-guest-sessions",level:3},{value:"Why Use Guest Sessions?",id:"why-use-guest-sessions",level:3},{value:"Count Sessions / Guest Sessions",id:"count-sessions--guest-sessions",level:3},{value:"SMB Client Usage",id:"smb-client-usage",level:2},{value:"Syntax &amp; Commands for SMB Client",id:"syntax--commands-for-smb-client",level:3},{value:"Example",id:"example",level:3}],m={toc:p},d="wrapper";function u(e){let{components:t,...s}=e;return(0,r.kt)(d,(0,a.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"network-service-enumeration"},"Network Service Enumeration"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"enumeration"},"Enumeration"),(0,r.kt)("h3",{id:"what--why-enumeration"},"What & Why Enumeration?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Enumeration")," is a process used by attackers to find weaknesses in a system by gathering information from different services. It's an important step in a successful attack.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Gathering information from the target activity.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Enumeration is also called scanning.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Digging up and validating the information which is gathered in information gathering/recon process.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"There are many network services like FTP, SMB, and more."))),(0,r.kt)("h2",{id:"services"},"Services"),(0,r.kt)("h3",{id:"what--why-service"},"What & Why Service?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To make jobs easy, services are created. For example, railways are created for public purpose or service, but to use the service, one has to obey the rules & regulations of railways, like buying tickets.")),(0,r.kt)("h2",{id:"service-enumeration"},"Service Enumeration"),(0,r.kt)("h3",{id:"what--why-service-enumeration"},"What & Why Service Enumeration?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"It's a process of digging up the services, finding services with loopholes."),(0,r.kt)("li",{parentName:"ul"},"Conducting a scan to verify service ports are open. After verification of which service is running, there are various tools for enumerations:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"NSE script of Enumerations based on LUA language"),(0,r.kt)("li",{parentName:"ul"},"Enum4linux based on Python"),(0,r.kt)("li",{parentName:"ul"},"Crackmapexec tools that were breached, created by NSA"),(0,r.kt)("li",{parentName:"ul"},"And many more...")))),(0,r.kt)("h2",{id:"smb-service"},"SMB Service"),(0,r.kt)("h3",{id:"what--why-smb"},"What & Why SMB?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Server Message Block (SMB)")," allows sharing resources with other computers over the network."),(0,r.kt)("li",{parentName:"ul"},"Computers (SMB clients) on a network can connect to SMB servers to access shared files and directories or perform tasks like downloading files over the Local Area Network."),(0,r.kt)("li",{parentName:"ul"},"SMB is an OSI application layer protocol that allows for file and device sharing and inter-process communication (IPC) between applications on a network through a client-server."),(0,r.kt)("li",{parentName:"ul"},"The same service in Linux OS is called SAMBA."),(0,r.kt)("li",{parentName:"ul"},"SMB uses ports 139 & 443.")),(0,r.kt)("h3",{id:"what-does-port-139-do"},"What does port 139 do?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Port 139 uses the ",(0,r.kt)("strong",{parentName:"li"},"NetBIOS")," protocol."),(0,r.kt)("li",{parentName:"ul"},"NetBIOS stands for Network Basic Input Output System."),(0,r.kt)("li",{parentName:"ul"},"Software applications that run on a NetBIOS network locate and identify each other via their NetBIOS names.")),(0,r.kt)("h3",{id:"what-does-netbios-do"},"What does NetBIOS do?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Allows communication between computers on local networks.")),(0,r.kt)("h3",{id:"port-445"},"Port 445"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Port 445 is known as ",(0,r.kt)("strong",{parentName:"li"},"SMB over IP")," or ",(0,r.kt)("strong",{parentName:"li"},"Server Message Block over IP"),"."),(0,r.kt)("li",{parentName:"ul"},"SMB in modern language is also referred to as ",(0,r.kt)("strong",{parentName:"li"},"Common Internet File System"),"."),(0,r.kt)("li",{parentName:"ul"},"SMB can run directly over TCP/IP without the need for NetBIOS over TCP/IP."),(0,r.kt)("li",{parentName:"ul"},"Port 445 is used for SMB when running over IP.")),(0,r.kt)("h3",{id:"ipc-share"},"IPC$ Share"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IPC$")," is a special hidden share that allows for inter-process communication (IPC) on Windows systems."),(0,r.kt)("li",{parentName:"ul"},"With an anonymous null session, you can access the IPC$ share and interact with exposed services.")),(0,r.kt)("h3",{id:"smb-protocol"},"SMB Protocol"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SMB is a ",(0,r.kt)("strong",{parentName:"li"},"response-request protocol")," used for sharing files, printers, and other resources on a network.")),(0,r.kt)("h3",{id:"client-server-connection"},"Client-Server Connection"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Clients connect to servers using ",(0,r.kt)("strong",{parentName:"li"},"TCP/IP")," or ",(0,r.kt)("strong",{parentName:"li"},"QUIC protocols"),".")),(0,r.kt)("h3",{id:"enumerating-netbios"},"Enumerating NetBIOS"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Enumerating NetBIOS provides information about the target computer group, domain, network shares, and computer names.")),(0,r.kt)("h3",{id:"possible-credentials"},"Possible Credentials"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Username(s)"),(0,r.kt)("th",{parentName:"tr",align:null},"Common Passwords"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"(blank)"),(0,r.kt)("td",{parentName:"tr",align:null},"(blank)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"guest"),(0,r.kt)("td",{parentName:"tr",align:null},"(blank)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Administrator, admin"),(0,r.kt)("td",{parentName:"tr",align:null},"(blank), password, administrator, admin")))),(0,r.kt)("h2",{id:"identification--scan"},"Identification & Scan"),(0,r.kt)("h3",{id:"smb-communication-via-wireshark"},"SMB Communication via Wireshark"),(0,r.kt)("p",null,"You can analyze SMB communication using Wireshark, a network protocol analyzer."),(0,r.kt)("h2",{id:"nblookup"},"nblookup"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Getting NetBIOS IP Address using ",(0,r.kt)("inlineCode",{parentName:"th"},"nmblookup")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"To retrieve NetBIOS IP addresses, use the following syntax and command:")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"nmblookup -A <IP>\n")),(0,r.kt)("h2",{id:"nbstate"},"nbstate"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Getting PC Information using ",(0,r.kt)("inlineCode",{parentName:"th"},"nbstate")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"NBSTATE_STATUS",src:n(9837).Z,width:"1462",height:"634"}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"To obtain PC information using ",(0,r.kt)("inlineCode",{parentName:"td"},"nbstate"),", use the following syntax and command:")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"nbtresults",src:n(4238).Z,width:"919",height:"776"}))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#nbstate\n#nbtstat \u2013A <target-IP-Addrs>\n")),(0,r.kt)("h2",{id:"nbtscan"},"nbtscan"),(0,r.kt)("h3",{id:"syntax--commands"},"Syntax & Commands"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"You can use ",(0,r.kt)("inlineCode",{parentName:"th"},"nbtscan")," to gather NetBIOS information from a target IP address. Below are the commands and syntax:"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"nbtscanresults",src:n(6404).Z,width:"1029",height:"516"}))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"To scan a target IP address:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#nbtscan \u2013r <Target-IP-Addr>\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For a verbose scan (to display more detailed information):"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#nbtscan \u2013v [verbose]\n")))),(0,r.kt)("h2",{id:"communication-between-two-windows-pcs"},"Communication between Two Windows PCs"),(0,r.kt)("p",null,"In this scenario, communication between two Windows PCs is established using ",(0,r.kt)("strong",{parentName:"p"},"SMB Port Number 445"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Windows"),(0,r.kt)("th",{parentName:"tr",align:null},"IP Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Windows 1 (initiating connection)"),(0,r.kt)("td",{parentName:"tr",align:null},"192.168.190.229")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Windows 2 (being accessed)"),(0,r.kt)("td",{parentName:"tr",align:null},"192.168.190.44")))),(0,r.kt)("h3",{id:"syntax--commands-1"},"Syntax & Commands"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"Communicatioinbwpc1",src:n(8597).Z,width:"1212",height:"672"}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"After Login Success:"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"communicationbwpc2",src:n(2607).Z,width:"1145",height:"626"}))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Accessing a File Packet:"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"communicationbwpc3",src:n(2429).Z,width:"1441",height:"687"}))))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"All the data exchanged during this communication is encrypted.")),(0,r.kt)("h2",{id:"smb-login-with-credentials--hashes"},"SMB Login with Credentials & Hashes"),(0,r.kt)("h3",{id:"syntax--commands-for-credentials"},"Syntax & Commands for Credentials"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Authenticate using credentials"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'smbmap -u "username" -p "password" -H <IP> -P <PORT>'))))),(0,r.kt)("h3",{id:"syntax--commands-for-hashes"},"Syntax & Commands for Hashes"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Authenticate using NTLM/LM hashes"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'smbmap -u "username" -p "<NT>:<LM>" -H <IP> -P <PORT>'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Establish SMB null session"),(0,r.kt)("td",{parentName:"tr",align:null},'If password response is "randomus" or blank, it\'s an SMB null session.')))),(0,r.kt)("h3",{id:"accessing-shares-using-smbclient"},"Accessing Shares using smbclient"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Access shares using smbclient"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"smbclient -U 'username[%passwd]' -L [--pw-nt-hash] //<Target-IP>"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"With ",(0,r.kt)("inlineCode",{parentName:"td"},"--pw-nt-hash")),(0,r.kt)("td",{parentName:"tr",align:null},"Use NT hash as the password (can be obtained using various methods).")))),(0,r.kt)("p",null,"Certainly, here's your provided Nmap scan syntax and commands formatted in markdown:"),(0,r.kt)("h2",{id:"nmap-scan"},"Nmap Scan"),(0,r.kt)("h3",{id:"syntax--commands-2"},"Syntax & Commands"),(0,r.kt)("p",null,"You can perform an Nmap scan using the following syntax and commands:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"nmap -Sv -n -Pn -p 138,445 <Target-IP>\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-Sv"),": Probe open ports to determine service/version info"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-n"),": No DNS resolution (speeds up the scan)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-Pn"),": Treat all hosts as online (skip host discovery)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-p 138,445"),": Scan ports 138 and 445")),(0,r.kt)("p",null,"Replace ",(0,r.kt)("inlineCode",{parentName:"p"},"<Target-IP>")," with the IP address of the target system."),(0,r.kt)("p",null,"Certainly, here's the information about SMB enumeration using NSE (Nmap Scripting Engine) presented using tables, bullet points, and code blocks within the markdown format:"),(0,r.kt)("h2",{id:"smb-enumeration"},"SMB Enumeration"),(0,r.kt)("h3",{id:"nse-nmap"},"NSE Nmap"),(0,r.kt)("h4",{id:"syntax--commands-for-smb-v1"},"Syntax & Commands For SMB V1"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Enumerate using SMB scripts"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"nmap --script smb-enum-*.nse 192.168.50.124"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Output:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Starting Nmap 7.94 ( https://nmap.org ) at 2023-06-26 21:46 IST\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:37 EDT\nNmap scan report for 192.168.100.130\n                                                                                                                                                                                                                  \n\u250c\u2500\u2500(root\u327fkali)-[/usr/share/nmap/scripts]\n\u2514\u2500# nmap --script smb-enum-*.nse 192.168.100.130\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:19 EDT\nFailed to resolve "smb-enum-groups.nse".\nFailed to resolve "smb-enum-processes.nse".\nFailed to resolve "smb-enum-services.nse".\nFailed to resolve "smb-enum-sessions.nse".\nFailed to resolve "smb-enum-shares.nse".\nFailed to resolve "smb-enum-users.nse".\nNmap scan report for 192.168.100.130\nHost is up (0.0068s latency).\nNot shown: 983 closed tcp ports (reset)\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n25/tcp   open  smtp\n80/tcp   open  http\n139/tcp  open  netbios-ssn\n443/tcp  open  https\n445/tcp  open  microsoft-ds\n512/tcp  open  exec\n513/tcp  open  login\n514/tcp  open  shell\n666/tcp  open  doom\n3306/tcp open  mysql\n5901/tcp open  vnc-1\n6001/tcp open  X11:1\n8080/tcp open  http-proxy\n8443/tcp open  https-alt\n9080/tcp open  glrpc\nMAC Address: 00:0C:29:9C:C7:94 (VMware)\n \nHost script results:\n| smb-enum-domains: \n|   Builtin\n|     Groups: n/a\n|     Users: n/a\n|     Creation time: unknown\n|     Passwords: min length: 5; min age: n/a days; max age: n/a days; history: n/a passwords\n|     Account lockout disabled\n|   BEE-BOX\n|     Groups: n/a\n|     Users: nobody\\x00, bee\\x00\n|     Creation time: unknown\n|     Passwords: min length: 5; min age: n/a days; max age: n/a days; history: n/a passwords\n|_    Account lockout disabled\n \nNmap done: 1 IP address (1 host up) scanned in 6.08 seconds\n')),(0,r.kt)("h4",{id:"windows"},"Windows"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Enumerate using SMB scripts"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"nmap --script smb-enum-*.nse 192.168.100.130"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Output:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:19 EDT\nFailed to resolve "smb-enum-groups.nse".\nFailed to resolve "smb-enum-processes.nse".\n...\nNmap scan report for 192.168.100.130\nHost is up (0.0068s latency).\n...\nNmap done: 1 IP address (1 host up) scanned in 6.08 seconds\n')),(0,r.kt)("h4",{id:"beebox"},"BeeBox"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Enumerate using SMB scripts"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"nmap -vv --script smb-*.nse 192.168.100.130"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Output:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Completed SYN Stealth Scan at 12:37, 0.12s elapsed (1000 total ports)\nNSE: Script scanning 192.168.100.130.\nNSE: Starting runlevel 1 (of 1) scan.\nInitiating NSE at 12:37\nCompleted NSE at 12:37, 6.30s elapsed\nNmap scan report for 192.168.100.130\nHost is up, received arp-response (0.020s latency).\nScanned at 2023-06-26 12:37:37 EDT for 7s\nNot shown: 983 closed tcp ports (reset)\nPORT     STATE SERVICE      REASON\n21/tcp   open  ftp          syn-ack ttl 64\n22/tcp   open  ssh          syn-ack ttl 64\n25/tcp   open  smtp         syn-ack ttl 64\n80/tcp   open  http         syn-ack ttl 64\n139/tcp  open  netbios-ssn  syn-ack ttl 64\n443/tcp  open  https        syn-ack ttl 64\n445/tcp  open  microsoft-ds syn-ack ttl 64\n512/tcp  open  exec         syn-ack ttl 64\n513/tcp  open  login        syn-ack ttl 64\n514/tcp  open  shell        syn-ack ttl 64\n666/tcp  open  doom         syn-ack ttl 64\n3306/tcp open  mysql        syn-ack ttl 64\n5901/tcp open  vnc-1        syn-ack ttl 64\n6001/tcp open  X11:1        syn-ack ttl 64\n8080/tcp open  http-proxy   syn-ack ttl 64\n8443/tcp open  https-alt    syn-ack ttl 64\n9080/tcp open  glrpc        syn-ack ttl 64\nMAC Address: 00:0C:29:9C:C7:94 (VMware)\n \nHost script results:\n| smb-brute: \n|_  No accounts found\n \nNSE: Script Post-scanning.\nNSE: Starting runlevel 1 (of 1) scan.\nInitiating NSE at 12:37\nCompleted NSE at 12:37, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 16.78 seconds\n           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.096KB)\n\n")),(0,r.kt)("h2",{id:"smb-enumeration-using-smbv2-scripts"},"SMB Enumeration Using SMBv2 Scripts"),(0,r.kt)("h3",{id:"syntax--commands-3"},"Syntax & Commands"),(0,r.kt)("p",null,"To enumerate SMBv2 using Nmap scripts, you can use the following commands:"),(0,r.kt)("p",null,"For Linux:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"nmap -vv --script smb2-*.nse 192.168.100.130\n")),(0,r.kt)("p",null,"For Windows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"nmap -vv --script smb2-*.nse 192.168.50.124\n")),(0,r.kt)("h3",{id:"output-examples"},"Output Examples"),(0,r.kt)("h4",{id:"output-linux"},"Output (Linux):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:38 EDT\nNSE: Loaded 1 scripts for scanning.\n...\nPORT     STATE SERVICE      REASON\n21/tcp   open  ftp          syn-ack ttl 64\n22/tcp   open  ssh          syn-ack ttl 64\n...\nHost script results:\n|_smb2-capabilities: SMB 2+ not supported\n...\nNmap done: 1 IP address (1 host up) scanned in 11.89 seconds\n")),(0,r.kt)("h4",{id:"output-windows"},"Output (Windows):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Starting Nmap 7.94 ( https://nmap.org ) at 2023-06-26 22:09 IST\nNSE: Loaded 4 scripts for scanning.\n...\nPORT     STATE SERVICE       REASON\n21/tcp   open  ftp           syn-ack\n22/tcp   open  ssh           syn-ack\n...\nHost script results:\n| smb2-capabilities: \n|   2:0:2: \n|     Distributed File System\n|   2:1:0: \n|     Distributed File System\n|     Leasing\n...\n| smb2-time: \n|   date: 2023-06-26T16:35:58\n...\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n...\nNmap done: 1 IP address (1 host up) scanned in 1.69 seconds\n")),(0,r.kt)("h3",{id:"enumeration-insights"},"Enumeration Insights"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"There are two types of sessions: Guest sessions (random password entered) and Null sessions (blank password entered)."),(0,r.kt)("li",{parentName:"ul"},"Null Sessions have no credentials, and authentication is performed over SMB."),(0,r.kt)("li",{parentName:"ul"},"Count Sessions or Guest Sessions typically have any name, and authentication is performed over SMB.")),(0,r.kt)("h2",{id:"guest-sessions-enumeration"},"Guest Sessions Enumeration"),(0,r.kt)("h3",{id:"what-are-guest-sessions"},"What are Guest Sessions?"),(0,r.kt)("p",null,"Guest sessions refer to cases where random passwords are entered for authentication attempts. These sessions are typically used to explore accessible resources without providing valid credentials."),(0,r.kt)("h3",{id:"why-use-guest-sessions"},"Why Use Guest Sessions?"),(0,r.kt)("p",null,"Guest sessions can be useful for probing systems to identify open shares, services, and other network resources. They allow you to interact with the system without using valid credentials."),(0,r.kt)("h3",{id:"count-sessions--guest-sessions"},"Count Sessions / Guest Sessions"),(0,r.kt)("p",null,"In some scenarios, you can perform count sessions or guest sessions by providing any name during authentication. The format is:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Authentication"),(0,r.kt)("th",{parentName:"tr",align:null},"SMB"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Any Name"),(0,r.kt)("td",{parentName:"tr",align:null},"AUTH")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"SMB")))),(0,r.kt)("h2",{id:"smb-client-usage"},"SMB Client Usage"),(0,r.kt)("h3",{id:"syntax--commands-for-smb-client"},"Syntax & Commands for SMB Client"),(0,r.kt)("p",null,"To use the SMB client (",(0,r.kt)("inlineCode",{parentName:"p"},"smbclient"),") for enumeration and interaction with shares, you can use the following commands:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Command"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Enumerate shares without a username and password"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"smbclient -L <Target-IP>"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Enumerate shares without a password (using ",(0,r.kt)("inlineCode",{parentName:"td"},"-N")," flag)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"smbclient -N -L <Target-IP>"))))),(0,r.kt)("h3",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"smbclient -N -L 192.168.100.130\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"The ",(0,r.kt)("inlineCode",{parentName:"th"},"-N")," flag indicates no password should be provided during the authentication attempt."))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{alt:"smbclientresults",src:n(6920).Z,width:"1528",height:"541"}))))))}u.isMDXComponent=!0},8597:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/communicationbwpcs1-5920fa9c5f4d03d799d3e149b5e8488d.png"},2607:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/communicationbwpcs2-b36d43aace37a99bf02ecba7ddb34b5b.png"},2429:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/communicationbwpcs3-767b9d1ae3b0e5f5dc0ca0356ce99dfa.png"},6404:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nbsscanresults-467c26839a3d9003c42620e793092111.png"},9837:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nbstatestatus-6e3aee5a303eba46803ba9f4c81f683a.png"},4238:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nbtstateresults-fd2b327258db38f6a4554b665babdf5a.png"},6920:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/smb_clientresults-9643adeb971bb2bf3c7bf4c9586d7d48.png"}}]);