<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-CyberSecurity/CyberrSecurity360/Network Service Enumeration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Network Service Enumeration | Hasan Rehni</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/journey/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/journey/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Network Service Enumeration | Hasan Rehni"><meta data-rh="true" name="description" content="---"><meta data-rh="true" property="og:description" content="---"><link data-rh="true" rel="icon" href="/journey/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration"><link data-rh="true" rel="alternate" href="https://github.com/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/journey/blog/rss.xml" title="Hasan Rehni RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/journey/blog/atom.xml" title="Hasan Rehni Atom Feed"><link rel="stylesheet" href="/journey/assets/css/styles.6a088124.css">
<link rel="preload" href="/journey/assets/js/runtime~main.c2615b4d.js" as="script">
<link rel="preload" href="/journey/assets/js/main.c3ddc6cb.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/journey/"><div class="navbar__logo"><img src="/journey/img/employeelogo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/journey/img/employeelogo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/journey/docs/category/cybersecurity">Cyber Security</a></div><div class="navbar__items navbar__items--right"><a href="https://bpdoxs.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">BPDOXS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/journey/docs/category/cybersecurity">CyberSecurity</a><button aria-label="Toggle the collapsible sidebar category &#x27;CyberSecurity&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/CCNA/Memory">CCNA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/CheckPoint/Checkpoint_intro">CheckPoint</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/Cisco ASA/ASAintro">Cisco ASA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/Cisco ISE/ISE Introduction">Cisco ISE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/Cisco NGFW">Cisco Next Generation Firewall Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cisco Next Generation Firewall Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/CyberSecurity360_OMAN_ANE-PTE">CyberrSecurity360</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/CyberSecurity360_OMAN_ANE-PTE">CyberSecurity360 Introduction.</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/Trade of Tools">Trade of Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/All About Linux">All About Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/The Begining of Hacking">The Beginning of Hacking !!!</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/Networking">Networking !</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/Foot Printing and More..">Foot Printing And More..</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/Basic Enum, Info Gathering &amp; Vulnerability Assessment">Basic Enum, Info Gathering &amp; Vulnerability Assessment.</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/The Craft of Network Scanning">The Craft of Network Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/journey/docs/CyberSecurity/CyberrSecurity360/Network Service Enumeration">Network Service Enumeration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/Palo Alto/Palo Alto Introduction">Palo Alto</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/journey/docs/CyberSecurity/VPN/VPN Introduction">VPN</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/journey/docs/Hasanresume">Hasan Rhani</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/journey/docs/Testing">Testing</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/journey/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/journey/docs/category/cybersecurity"><span itemprop="name">CyberSecurity</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CyberrSecurity360</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Network Service Enumeration</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Network Service Enumeration</h1><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration">Enumeration<a href="#enumeration" class="hash-link" aria-label="Direct link to Enumeration" title="Direct link to Enumeration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-enumeration"><strong>What &amp; Why Enumeration?</strong><a href="#what--why-enumeration" class="hash-link" aria-label="Direct link to what--why-enumeration" title="Direct link to what--why-enumeration">​</a></h3><ul><li><p><strong>Enumeration</strong> is a process used by attackers to find weaknesses in a system by gathering information from different services. It&#x27;s an important step in a successful attack.</p></li><li><p>Gathering information from the target activity.</p></li><li><p>Enumeration is also called scanning.</p></li><li><p>Digging up and validating the information which is gathered in information gathering/recon process.</p></li><li><p>There are many network services like FTP, SMB, and more.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="services"><strong>Services</strong><a href="#services" class="hash-link" aria-label="Direct link to services" title="Direct link to services">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-service"><strong>What &amp; Why Service?</strong><a href="#what--why-service" class="hash-link" aria-label="Direct link to what--why-service" title="Direct link to what--why-service">​</a></h3><ul><li>To make jobs easy, services are created. For example, railways are created for public purpose or service, but to use the service, one has to obey the rules &amp; regulations of railways, like buying tickets.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-enumeration"><strong>Service Enumeration</strong><a href="#service-enumeration" class="hash-link" aria-label="Direct link to service-enumeration" title="Direct link to service-enumeration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-service-enumeration"><strong>What &amp; Why Service Enumeration?</strong><a href="#what--why-service-enumeration" class="hash-link" aria-label="Direct link to what--why-service-enumeration" title="Direct link to what--why-service-enumeration">​</a></h3><ul><li>It&#x27;s a process of digging up the services, finding services with loopholes.</li><li>Conducting a scan to verify service ports are open. After verification of which service is running, there are various tools for enumerations:<ul><li>NSE script of Enumerations based on LUA language</li><li>Enum4linux based on Python</li><li>Crackmapexec tools that were breached, created by NSA</li><li>And many more...</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smb-service"><strong>SMB Service</strong><a href="#smb-service" class="hash-link" aria-label="Direct link to smb-service" title="Direct link to smb-service">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-smb"><strong>What &amp; Why SMB?</strong><a href="#what--why-smb" class="hash-link" aria-label="Direct link to what--why-smb" title="Direct link to what--why-smb">​</a></h3><ul><li><strong>Server Message Block (SMB)</strong> allows sharing resources with other computers over the network.</li><li>Computers (SMB clients) on a network can connect to SMB servers to access shared files and directories or perform tasks like downloading files over the Local Area Network.</li><li>SMB is an OSI application layer protocol that allows for file and device sharing and inter-process communication (IPC) between applications on a network through a client-server.</li><li>The same service in Linux OS is called SAMBA.</li><li>SMB uses ports 139 &amp; 443.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-port-139-do"><strong>What does port 139 do?</strong><a href="#what-does-port-139-do" class="hash-link" aria-label="Direct link to what-does-port-139-do" title="Direct link to what-does-port-139-do">​</a></h4><ul><li>Port 139 uses the <strong>NetBIOS</strong> protocol.</li><li>NetBIOS stands for Network Basic Input Output System.</li><li>Software applications that run on a NetBIOS network locate and identify each other via their NetBIOS names.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-netbios-do"><strong>What does NetBIOS do?</strong><a href="#what-does-netbios-do" class="hash-link" aria-label="Direct link to what-does-netbios-do" title="Direct link to what-does-netbios-do">​</a></h4><ul><li>Allows communication between computers on local networks.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="port-445"><strong>Port 445</strong><a href="#port-445" class="hash-link" aria-label="Direct link to port-445" title="Direct link to port-445">​</a></h4><ul><li>Port 445 is known as <strong>SMB over IP</strong> or <strong>Server Message Block over IP</strong>.</li><li>SMB in modern language is also referred to as <strong>Common Internet File System</strong>.</li><li>SMB can run directly over TCP/IP without the need for NetBIOS over TCP/IP.</li><li>Port 445 is used for SMB when running over IP.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ipc-share"><strong>IPC$ Share</strong><a href="#ipc-share" class="hash-link" aria-label="Direct link to ipc-share" title="Direct link to ipc-share">​</a></h4><ul><li><strong>IPC$</strong> is a special hidden share that allows for inter-process communication (IPC) on Windows systems.</li><li>With an anonymous null session, you can access the IPC$ share and interact with exposed services.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smb-protocol"><strong>SMB Protocol</strong><a href="#smb-protocol" class="hash-link" aria-label="Direct link to smb-protocol" title="Direct link to smb-protocol">​</a></h4><ul><li>SMB is a <strong>response-request protocol</strong> used for sharing files, printers, and other resources on a network.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="client-server-connection"><strong>Client-Server Connection</strong><a href="#client-server-connection" class="hash-link" aria-label="Direct link to client-server-connection" title="Direct link to client-server-connection">​</a></h4><ul><li>Clients connect to servers using <strong>TCP/IP</strong> or <strong>QUIC protocols</strong>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enumerating-netbios"><strong>Enumerating NetBIOS</strong><a href="#enumerating-netbios" class="hash-link" aria-label="Direct link to enumerating-netbios" title="Direct link to enumerating-netbios">​</a></h4><ul><li>Enumerating NetBIOS provides information about the target computer group, domain, network shares, and computer names.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="possible-credentials"><strong>Possible Credentials</strong><a href="#possible-credentials" class="hash-link" aria-label="Direct link to possible-credentials" title="Direct link to possible-credentials">​</a></h4><table><thead><tr><th>Username(s)</th><th>Common Passwords</th></tr></thead><tbody><tr><td>(blank)</td><td>(blank)</td></tr><tr><td>guest</td><td>(blank)</td></tr><tr><td>Administrator, admin</td><td>(blank), password, administrator, admin</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scan"><strong>Identification &amp; Scan</strong><a href="#identification--scan" class="hash-link" aria-label="Direct link to identification--scan" title="Direct link to identification--scan">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smb-communication-via-wireshark"><strong>SMB Communication via Wireshark</strong><a href="#smb-communication-via-wireshark" class="hash-link" aria-label="Direct link to smb-communication-via-wireshark" title="Direct link to smb-communication-via-wireshark">​</a></h4><p>You can analyze SMB communication using Wireshark, a network protocol analyzer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nblookup"><strong>nblookup</strong><a href="#nblookup" class="hash-link" aria-label="Direct link to nblookup" title="Direct link to nblookup">​</a></h4><table><thead><tr><th>Getting NetBIOS IP Address using <code>nmblookup</code></th></tr></thead><tbody><tr><td>To retrieve NetBIOS IP addresses, use the following syntax and command:</td></tr></tbody></table><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmblookup -A </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nbstate"><strong>nbstate</strong><a href="#nbstate" class="hash-link" aria-label="Direct link to nbstate" title="Direct link to nbstate">​</a></h4><table><thead><tr><th>Getting PC Information using <code>nbstate</code></th></tr></thead><tbody><tr><td><img loading="lazy" alt="NBSTATE_STATUS" src="/journey/assets/images/nbstatestatus-6e3aee5a303eba46803ba9f4c81f683a.png" width="1462" height="634" class="img_ev3q"></td></tr><tr><td>To obtain PC information using <code>nbstate</code>, use the following syntax and command:</td></tr><tr><td><img loading="lazy" alt="nbtresults" src="/journey/assets/images/nbtstateresults-fd2b327258db38f6a4554b665babdf5a.png" width="919" height="776" class="img_ev3q"></td></tr></tbody></table><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#nbstate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#nbtstat –A &lt;target-IP-Addrs&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nbtscan"><strong>nbtscan</strong><a href="#nbtscan" class="hash-link" aria-label="Direct link to nbtscan" title="Direct link to nbtscan">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands"><strong>Syntax &amp; Commands</strong><a href="#syntax--commands" class="hash-link" aria-label="Direct link to syntax--commands" title="Direct link to syntax--commands">​</a></h4><table><thead><tr><th>You can use <code>nbtscan</code> to gather NetBIOS information from a target IP address. Below are the commands and syntax:</th></tr></thead><tbody><tr><td><img loading="lazy" alt="nbtscanresults" src="/journey/assets/images/nbsscanresults-467c26839a3d9003c42620e793092111.png" width="1029" height="516" class="img_ev3q"></td></tr></tbody></table><ul><li><p>To scan a target IP address:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#nbtscan –r &lt;Target-IP-Addr&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>For a verbose scan (to display more detailed information):</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#nbtscan –v [verbose]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="communication-between-two-windows-pcs"><strong>Communication between Two Windows PCs</strong><a href="#communication-between-two-windows-pcs" class="hash-link" aria-label="Direct link to communication-between-two-windows-pcs" title="Direct link to communication-between-two-windows-pcs">​</a></h2><p>In this scenario, communication between two Windows PCs is established using <strong>SMB Port Number 445</strong>.</p><table><thead><tr><th>Windows</th><th>IP Address</th></tr></thead><tbody><tr><td>Windows 1 (initiating connection)</td><td>192.168.190.229</td></tr><tr><td>Windows 2 (being accessed)</td><td>192.168.190.44</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-1"><strong>Syntax &amp; Commands</strong><a href="#syntax--commands-1" class="hash-link" aria-label="Direct link to syntax--commands-1" title="Direct link to syntax--commands-1">​</a></h4><table><thead><tr><th>Description</th></tr></thead><tbody><tr><td><img loading="lazy" alt="Communicatioinbwpc1" src="/journey/assets/images/communicationbwpcs1-5920fa9c5f4d03d799d3e149b5e8488d.png" width="1212" height="672" class="img_ev3q"></td></tr><tr><td><strong>After Login Success:</strong></td></tr><tr><td><img loading="lazy" alt="communicationbwpc2" src="/journey/assets/images/communicationbwpcs2-b36d43aace37a99bf02ecba7ddb34b5b.png" width="1145" height="626" class="img_ev3q"></td></tr><tr><td><strong>Accessing a File Packet:</strong></td></tr><tr><td><img loading="lazy" alt="communicationbwpc3" src="/journey/assets/images/communicationbwpcs3-767b9d1ae3b0e5f5dc0ca0356ce99dfa.png" width="1441" height="687" class="img_ev3q"></td></tr></tbody></table><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>All the data exchanged during this communication is encrypted.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smb-login-with-credentials--hashes"><strong>SMB Login with Credentials &amp; Hashes</strong><a href="#smb-login-with-credentials--hashes" class="hash-link" aria-label="Direct link to smb-login-with-credentials--hashes" title="Direct link to smb-login-with-credentials--hashes">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-for-credentials"><strong>Syntax &amp; Commands for Credentials</strong><a href="#syntax--commands-for-credentials" class="hash-link" aria-label="Direct link to syntax--commands-for-credentials" title="Direct link to syntax--commands-for-credentials">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Authenticate using credentials</td><td><code>smbmap -u &quot;username&quot; -p &quot;password&quot; -H &lt;IP&gt; -P &lt;PORT&gt;</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-for-hashes"><strong>Syntax &amp; Commands for Hashes</strong><a href="#syntax--commands-for-hashes" class="hash-link" aria-label="Direct link to syntax--commands-for-hashes" title="Direct link to syntax--commands-for-hashes">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Authenticate using NTLM/LM hashes</td><td><code>smbmap -u &quot;username&quot; -p &quot;&lt;NT&gt;:&lt;LM&gt;&quot; -H &lt;IP&gt; -P &lt;PORT&gt;</code></td></tr><tr><td>Establish SMB null session</td><td>If password response is &quot;randomus&quot; or blank, it&#x27;s an SMB null session.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-shares-using-smbclient"><strong>Accessing Shares using smbclient</strong><a href="#accessing-shares-using-smbclient" class="hash-link" aria-label="Direct link to accessing-shares-using-smbclient" title="Direct link to accessing-shares-using-smbclient">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Access shares using smbclient</td><td><code>smbclient -U &#x27;username[%passwd]&#x27; -L [--pw-nt-hash] //&lt;Target-IP&gt;</code></td></tr><tr><td>With <code>--pw-nt-hash</code></td><td>Use NT hash as the password (can be obtained using various methods).</td></tr></tbody></table><p>Certainly, here&#x27;s your provided Nmap scan syntax and commands formatted in markdown:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-scan"><strong>Nmap Scan</strong><a href="#nmap-scan" class="hash-link" aria-label="Direct link to nmap-scan" title="Direct link to nmap-scan">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-2">Syntax &amp; Commands**<a href="#syntax--commands-2" class="hash-link" aria-label="Direct link to Syntax &amp; Commands**" title="Direct link to Syntax &amp; Commands**">​</a></h4><p>You can perform an Nmap scan using the following syntax and commands:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -Sv -n -Pn -p </span><span class="token number" style="color:#36acaa">138,445</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Target-IP</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>-Sv</code>: Probe open ports to determine service/version info</li><li><code>-n</code>: No DNS resolution (speeds up the scan)</li><li><code>-Pn</code>: Treat all hosts as online (skip host discovery)</li><li><code>-p 138,445</code>: Scan ports 138 and 445</li></ul><p>Replace <code>&lt;Target-IP&gt;</code> with the IP address of the target system.</p><p>Certainly, here&#x27;s the information about SMB enumeration using NSE (Nmap Scripting Engine) presented using tables, bullet points, and code blocks within the markdown format:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smb-enumeration"><strong>SMB Enumeration</strong><a href="#smb-enumeration" class="hash-link" aria-label="Direct link to smb-enumeration" title="Direct link to smb-enumeration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap"><strong>NSE Nmap</strong><a href="#nse-nmap" class="hash-link" aria-label="Direct link to nse-nmap" title="Direct link to nse-nmap">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-for-smb-v1"><strong>Syntax &amp; Commands For SMB V1</strong><a href="#syntax--commands-for-smb-v1" class="hash-link" aria-label="Direct link to syntax--commands-for-smb-v1" title="Direct link to syntax--commands-for-smb-v1">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Enumerate using SMB scripts</td><td><code>nmap --script smb-enum-*.nse 192.168.50.124</code></td></tr></tbody></table><table><thead><tr><th><strong>Output:</strong></th></tr></thead><tbody><tr><td><img loading="lazy" alt="NMAP_SCAN_SMB_SCRIPT" src="/journey/assets/images/nmapscansmbscripty-22afcdb1280e013da57905ce3aa67503.png" width="2184" height="2506" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="windows">Windows<a href="#windows" class="hash-link" aria-label="Direct link to Windows" title="Direct link to Windows">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Enumerate using SMB scripts</td><td><code>nmap --script smb-enum-*.nse 192.168.100.130</code></td></tr></tbody></table><p><strong>Output:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:19 EDT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failed to resolve &quot;smb-enum-groups.nse&quot;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failed to resolve &quot;smb-enum-processes.nse&quot;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap scan report for 192.168.100.130</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host is up (0.0068s latency).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 6.08 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="beebox"><strong>BeeBox</strong><a href="#beebox" class="hash-link" aria-label="Direct link to beebox" title="Direct link to beebox">​</a></h4><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Enumerate using SMB scripts</td><td><code>nmap -vv --script smb-*.nse 192.168.100.130</code></td></tr></tbody></table><table><thead><tr><th><strong>Output:</strong></th></tr></thead><tbody><tr><td><img loading="lazy" alt="NMAP_SCAN_SMB_STEALTH" src="/journey/assets/images/nmapscansmbsteath-f01a526c78c2f96fb6e6b9a21e9523be.png" width="2184" height="1916" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smb-enumeration-using-smbv2-scripts"><strong>SMB Enumeration Using SMBv2 Scripts</strong><a href="#smb-enumeration-using-smbv2-scripts" class="hash-link" aria-label="Direct link to smb-enumeration-using-smbv2-scripts" title="Direct link to smb-enumeration-using-smbv2-scripts">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-3"><strong>Syntax &amp; Commands</strong><a href="#syntax--commands-3" class="hash-link" aria-label="Direct link to syntax--commands-3" title="Direct link to syntax--commands-3">​</a></h4><p>To enumerate SMBv2 using Nmap scripts, you can use the following commands:</p><p>For Linux:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -vv --script smb2-*.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.100.130</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For Windows:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -vv --script smb2-*.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-examples"><strong>Output Examples</strong><a href="#output-examples" class="hash-link" aria-label="Direct link to output-examples" title="Direct link to output-examples">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-linux"><strong>Output (Linux):</strong><a href="#output-linux" class="hash-link" aria-label="Direct link to output-linux" title="Direct link to output-linux">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-26 12:38 EDT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NSE: Loaded 1 scripts for scanning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT     STATE SERVICE      REASON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">21/tcp   open  ftp          syn-ack ttl 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22/tcp   open  ssh          syn-ack ttl 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|_smb2-capabilities: SMB 2+ not supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 11.89 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-windows"><strong>Output (Windows):</strong><a href="#output-windows" class="hash-link" aria-label="Direct link to output-windows" title="Direct link to output-windows">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.94 ( https://nmap.org ) at 2023-06-26 22:09 IST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NSE: Loaded 4 scripts for scanning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT     STATE SERVICE       REASON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">21/tcp   open  ftp           syn-ack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22/tcp   open  ssh           syn-ack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| smb2-capabilities: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   2:0:2: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     Distributed File System</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   2:1:0: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     Distributed File System</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     Leasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| smb2-time: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   date: 2023-06-26T16:35:58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| smb2-security-mode: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   3:1:1: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|_    Message signing enabled but not required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 1.69 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-insights"><strong>Enumeration Insights</strong><a href="#enumeration-insights" class="hash-link" aria-label="Direct link to enumeration-insights" title="Direct link to enumeration-insights">​</a></h3><ul><li>There are two types of sessions: Guest sessions (random password entered) and Null sessions (blank password entered).</li><li>Null Sessions have no credentials, and authentication is performed over SMB.</li><li>Count Sessions or Guest Sessions typically have any name, and authentication is performed over SMB.</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guest-sessions-enumeration"><strong>Guest Sessions Enumeration</strong><a href="#guest-sessions-enumeration" class="hash-link" aria-label="Direct link to guest-sessions-enumeration" title="Direct link to guest-sessions-enumeration">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-guest-sessions"><strong>What are Guest Sessions?</strong><a href="#what-are-guest-sessions" class="hash-link" aria-label="Direct link to what-are-guest-sessions" title="Direct link to what-are-guest-sessions">​</a></h3><p>Guest sessions refer to cases where random passwords are entered for authentication attempts. These sessions are typically used to explore accessible resources without providing valid credentials.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-use-guest-sessions"><strong>Why Use Guest Sessions?</strong><a href="#why-use-guest-sessions" class="hash-link" aria-label="Direct link to why-use-guest-sessions" title="Direct link to why-use-guest-sessions">​</a></h3><p>Guest sessions can be useful for probing systems to identify open shares, services, and other network resources. They allow you to interact with the system without using valid credentials.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="count-sessions--guest-sessions"><strong>Count Sessions / Guest Sessions</strong><a href="#count-sessions--guest-sessions" class="hash-link" aria-label="Direct link to count-sessions--guest-sessions" title="Direct link to count-sessions--guest-sessions">​</a></h3><p>In some scenarios, you can perform count sessions or guest sessions by providing any name during authentication. The format is:</p><table><thead><tr><th>Authentication</th><th>SMB</th></tr></thead><tbody><tr><td>Any Name</td><td>AUTH</td></tr><tr><td></td><td>SMB</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="smb-client-usage"><strong>SMB Client Usage</strong><a href="#smb-client-usage" class="hash-link" aria-label="Direct link to smb-client-usage" title="Direct link to smb-client-usage">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntax--commands-for-smb-client"><strong>Syntax &amp; Commands for SMB Client</strong><a href="#syntax--commands-for-smb-client" class="hash-link" aria-label="Direct link to syntax--commands-for-smb-client" title="Direct link to syntax--commands-for-smb-client">​</a></h4><p>To use the SMB client (<code>smbclient</code>) for enumeration and interaction with shares, you can use the following commands:</p><table><thead><tr><th>Description</th><th>Command</th></tr></thead><tbody><tr><td>Enumerate shares without a username and password</td><td><code>smbclient -L &lt;Target-IP&gt;</code></td></tr><tr><td>Enumerate shares without a password (using <code>-N</code> flag)</td><td><code>smbclient -N -L &lt;Target-IP&gt;</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example"><strong>Example</strong><a href="#example" class="hash-link" aria-label="Direct link to example" title="Direct link to example">​</a></h4><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">smbclient -N -L </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.100.130</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>The <code>-N</code> flag indicates no password should be provided during the authentication attempt.</th></tr></thead><tbody><tr><td><img loading="lazy" alt="smbclientresults" src="/journey/assets/images/smb_clientresults-9643adeb971bb2bf3c7bf4c9586d7d48.png" width="1528" height="541" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smbmap"><strong>smbmap</strong><a href="#smbmap" class="hash-link" aria-label="Direct link to smbmap" title="Direct link to smbmap">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>smbmap –u ‘anonymous’ -p ‘anonymous’ &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="SMBMAP_GUEST_SESSION" src="/journey/assets/images/smbmapguestsession-3830e4016bf899413817f90557600928.png" width="2184" height="1100" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enum4linux"><strong>Enum4linux</strong><a href="#enum4linux" class="hash-link" aria-label="Direct link to enum4linux" title="Direct link to enum4linux">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>enum4linux [-u &quot;&lt;username&gt;&quot; -p &quot;&lt;passwd&gt;&quot;] &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="ENUM4LINUX_BASIC_SCAN" src="/journey/assets/images/enum4linuxbasicscan-363176c5a7a1bd914400c8ca0a54c631.png" width="2184" height="1552" class="img_ev3q"></td></tr><tr><td><strong>-a</strong> Will do Basic Enumeration &amp; <strong>-A</strong> will do Aggressive Enumeration</td></tr><tr><td><code>#enum4linux -a [-u &quot;&lt;username&gt;&quot; -p &quot;&lt;passwd&gt;&quot;] &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="ENUM4LINUX_BASIC_SCAN2" src="/journey/assets/images/enum4linuxbasicscan2-a730989e4ba253067595b236751b5469.png" width="2184" height="7312" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="impacket-smbclient"><strong>Impacket-smbclient</strong><a href="#impacket-smbclient" class="hash-link" aria-label="Direct link to impacket-smbclient" title="Direct link to impacket-smbclient">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code> impacket-smbclient://&lt;Username&gt;@&lt;target-ip&gt;  (for windows)</code></td></tr><tr><td><img loading="lazy" alt="IMPACT-SMBCLIENT_BASIC_SCAN" src="/journey/assets/images/impacket-smbscan-3ad8521736eb284b0ef8b83fc6884cc5.png" width="2184" height="2142" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crackmapexec-the-brute-force--usespassword-spray-"><strong>Crackmapexec The Brute Force &amp; Uses/Password Spray </strong><a href="#crackmapexec-the-brute-force--usespassword-spray-" class="hash-link" aria-label="Direct link to crackmapexec-the-brute-force--usespassword-spray-" title="Direct link to crackmapexec-the-brute-force--usespassword-spray-">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>crackmapexec smb &lt;IP&gt; -u &#x27;username.txt&#x27; -p &#x27;password.txt&#x27;</code></td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u &#x27;username&#x27;.txt -H &#x27;&lt;HASH&gt;</code></td></tr><tr><td>IN crackmapexec Pwn3d means correct credentials.</td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u &#x27;username&#x27;.txt -p &#x27;password.txt&#x27; --shares</code></td></tr><tr><td><img loading="lazy" alt="CRACKMAPEXEC_SCAN" src="/journey/assets/images/crackmapexexecsmbscan-01c54b24d3a43bb628aaa9cc1b4979e0.png" width="2184" height="7040" class="img_ev3q"></td></tr><tr><td><code>crackmapexec smb &lt;IP_Addres&gt; --users [-u &lt;username&gt; -p &lt;password&gt;]</code></td></tr><tr><td><img loading="lazy" alt="CRACKMAPEXEC_BASIC_SCAN_1" src="/journey/assets/images/crackmapexecsmbscan1-993210d2bc2a6f5b298f24e9a6efea1f.png" width="2184" height="464" class="img_ev3q"></td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u &#x27;username&#x27; -p &#x27;password&#x27; --shares #Guest user</code></td></tr><tr><td>OR</td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u &#x27;username&#x27; -H &#x27;&lt;HASH&gt;&#x27; --shares #Guest user</code></td></tr><tr><td><img loading="lazy" alt="CRACKMAPEXEC_SCAN_2" src="/journey/assets/images/crackmapexecscan2-528c162e6aa7a45a5c00190f8f077394.png" width="2184" height="646" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="null-sessions--enumeration"><strong>Null Sessions  Enumeration</strong><a href="#null-sessions--enumeration" class="hash-link" aria-label="Direct link to null-sessions--enumeration" title="Direct link to null-sessions--enumeration">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-null-sessions"><strong>What &amp; Why Null Sessions</strong><a href="#what--why-null-sessions" class="hash-link" aria-label="Direct link to what--why-null-sessions" title="Direct link to what--why-null-sessions">​</a></h4><ul><li>Null sessions. Means blank password entered.</li><li>Null Sessions ==&gt; NO Credentials ==&gt; AUTH ==&gt; SMB</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smbclinet"><strong>Smbclinet</strong><a href="#smbclinet" class="hash-link" aria-label="Direct link to smbclinet" title="Direct link to smbclinet">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td>smb client without username and password</td></tr><tr><td><code>smbclient -L &lt;Target-IP&gt;</code></td></tr><tr><td>-N means –no passwords</td></tr><tr><td><code>smbclient -N -L &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="SMBCLIENT_BASIC_SCAN" src="/journey/assets/images/smbclinetbasicscan-38b8972be00525750cffd87811d5d317.png" width="902" height="670" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smbmap-1"><strong>Smbmap</strong><a href="#smbmap-1" class="hash-link" aria-label="Direct link to smbmap-1" title="Direct link to smbmap-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>smb –u’’ -p ‘’ -H &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="SMBMAP_NULL_BASIC_SCAN" src="/journey/assets/images/smbmapnullbasicscan-08aec9a9478e6f8c8359394945c49fdf.png" width="2184" height="964" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="enum4linux-1"><strong>Enum4linux</strong><a href="#enum4linux-1" class="hash-link" aria-label="Direct link to enum4linux-1" title="Direct link to enum4linux-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>enum4linux [-u &quot;&lt;username&gt;&quot; -p &quot;&lt;passwd&gt;&quot;] &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="EMUN4LINUX_BASIC_SCAN_NULL" src="/journey/assets/images/enum4linuxnullbasicscan-3ff1e38dea63db6178b9b0b98494d1fb.png" width="2184" height="4092" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crackmapexec"><strong>Crackmapexec</strong><a href="#crackmapexec" class="hash-link" aria-label="Direct link to crackmapexec" title="Direct link to crackmapexec">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>crackmapexec smb &lt;IP&gt; -u blank-p blank#Guest user</code></td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u blank-H &#x27;&lt;HASH&gt;</code></td></tr><tr><td><code>crackmapexec smb &lt;IP&gt; -u blank-p blank--shares </code></td></tr><tr><td><img loading="lazy" alt="CRACKMAPEXEC_NULL_SCAN" src="/journey/assets/images/crackmapexecnullscan-225d801db5128942802cafc07189cf4f.png" width="2184" height="2686" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ftp"><strong>FTP</strong><a href="#ftp" class="hash-link" aria-label="Direct link to ftp" title="Direct link to ftp">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-ftp"><strong>What &amp; Why FTP</strong><a href="#what--why-ftp" class="hash-link" aria-label="Direct link to what--why-ftp" title="Direct link to what--why-ftp">​</a></h3><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">FTP</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">What is Communication Model does FTP Used?</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">What the standard FTP Port ?</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">FTP is a File Transfer Protocol Which is commonly used for transferring files from various devices.</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">Clinet-Server</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">Port Number 21</div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scan-1"><strong>Identification &amp; Scan</strong><a href="#identification--scan-1" class="hash-link" aria-label="Direct link to identification--scan-1" title="Direct link to identification--scan-1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap"><strong>Nmap</strong><a href="#nmap" class="hash-link" aria-label="Direct link to nmap" title="Direct link to nmap">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td>Output</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──(hasanrehni㉿kali-Hasan)-[~/credentails]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ nmap -p 21 192.168.50.124                                                                                                                            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap 7.94 ( https://nmap.org ) at 2023-06-27 00:40 IST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap scan report for 192.168.50.124</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host is up (0.00028s latency).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">21/tcp open  ftp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 0.05 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumerating-ftp"><strong>Enumerating FTP</strong><a href="#enumerating-ftp" class="hash-link" aria-label="Direct link to enumerating-ftp" title="Direct link to enumerating-ftp">​</a></h3><ul><li>There are various digging up on various <strong>services Enumerations</strong> which is Network Service Enumeration</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-enumeration"><strong>NSE Enumeration</strong><a href="#nse-enumeration" class="hash-link" aria-label="Direct link to nse-enumeration" title="Direct link to nse-enumeration">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># nmap -Pn --script ftp-*.nse &lt;Target-ip&gt;</code></td></tr><tr><td><img loading="lazy" alt="ftp-nmap-scan" src="/journey/assets/images/ftpnmapscan-295205c92563318c4903edba00df6b29.png" width="2184" height="3774" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-ftp-anonymous-login-"><strong>What is FTP Anonymous Login ?</strong><a href="#what-is-ftp-anonymous-login-" class="hash-link" aria-label="Direct link to what-is-ftp-anonymous-login-" title="Direct link to what-is-ftp-anonymous-login-">​</a></h4><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>In FTP There is Anonymous Login Functional open but current it does not open by defaults.
How does the nmap nse ftp-anon verify that its ftp anon open</p></div></div><table><thead><tr><th><img loading="lazy" alt="ftp-script-scan" src="/journey/assets/images/frpscriptdetails-5ed2074fe31a008fd6de2b80a4dca999.png" width="2184" height="1962" class="img_ev3q"></th></tr></thead></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ftp-web-access"><strong>FTP Web Access</strong><a href="#ftp-web-access" class="hash-link" aria-label="Direct link to ftp-web-access" title="Direct link to ftp-web-access">​</a></h4><table><thead><tr><th><strong>Uploading &amp; Executing through web</strong></th></tr></thead><tbody><tr><td><code>#ftp://&lt;target-ip&gt;</code></td></tr><tr><td><img loading="lazy" alt="ftp-web-login1" src="/journey/assets/images/ftpweblogini1-1fa0d66fbaee385f00d036b7e78cd63b.png" width="750" height="272" class="img_ev3q"></td></tr><tr><td><img loading="lazy" alt="ftp-web-login2" src="/journey/assets/images/ftpweblogini2-7cc27bda998bb8c377003780debcffdc.png" width="744" height="796" class="img_ev3q"></td></tr><tr><td><img loading="lazy" alt="ftp-web-login3" src="/journey/assets/images/ftpweblogini3-d71677404a5d98d68746ea541a2114ea.png" width="750" height="220" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-forces--passwordusers-spray"><strong>Brute Forces &amp; Password/Users Spray</strong><a href="#brute-forces--passwordusers-spray" class="hash-link" aria-label="Direct link to brute-forces--passwordusers-spray" title="Direct link to brute-forces--passwordusers-spray">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hydra"><strong>Hydra</strong><a href="#hydra" class="hash-link" aria-label="Direct link to hydra" title="Direct link to hydra">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#hydra -L users.txt -P passwords.txt IP ftp</code></td></tr><tr><td><img loading="lazy" alt="ftp-hydra" src="/journey/assets/images/ftphydra-d6b3d58ff073f9b2dfa0454ff4cb5181.png" width="2184" height="2506" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="winrm"><strong>WinRM</strong><a href="#winrm" class="hash-link" aria-label="Direct link to winrm" title="Direct link to winrm">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-winrm-"><strong>What &amp; Why WinRM ?</strong><a href="#what--why-winrm-" class="hash-link" aria-label="Direct link to what--why-winrm-" title="Direct link to what--why-winrm-">​</a></h4><ul><li>Windows Remote Management </li><li>This is a service remotely manage a particular device in for the windows environment.<ul><li>Uses the Port 5985 for non-encrypted &amp; Port 5986 is for encrypted.</li><li>In Windows Server this service is enabled but in Normal in windows this service this disable </li><li>To Enable the PowerShell commands is #Enable-Psremoting –Force</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scan-2"><strong>Identification &amp; Scan</strong><a href="#identification--scan-2" class="hash-link" aria-label="Direct link to identification--scan-2" title="Direct link to identification--scan-2">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-1"><strong>Nmap</strong><a href="#nmap-1" class="hash-link" aria-label="Direct link to nmap-1" title="Direct link to nmap-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><img loading="lazy" alt="nmap-scan" src="/journey/assets/images/nmapscan-248992029d8b7b6fd5fb1e19ecdea272.png" width="2184" height="646" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-winrm"><strong>Enumeration WinRM</strong><a href="#enumeration-winrm" class="hash-link" aria-label="Direct link to enumeration-winrm" title="Direct link to enumeration-winrm">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="evil-winrm"><strong>Evil-winrm</strong><a href="#evil-winrm" class="hash-link" aria-label="Direct link to evil-winrm" title="Direct link to evil-winrm">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#gem install evil-winrm</code></td></tr><tr><td><code>#evil-winrm -i [Target-IP] -u Administrator -p &#x27;password&#x27;</code></td></tr><tr><td><code>#evil-winrm -i 10.11.1.111 -u Administrator -H &#x27;hash-pass&#x27; -s /scripts/folder</code></td></tr><tr><td><img loading="lazy" alt="evil-winrm-scan" src="/journey/assets/images/evilwinrmscan-9f54aadc3442b36ac7e4c45684fb17b6.png" width="2184" height="782" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-forces--passwordusers-spray-1"><strong>Brute Forces &amp; Password/Users Spray</strong><a href="#brute-forces--passwordusers-spray-1" class="hash-link" aria-label="Direct link to brute-forces--passwordusers-spray-1" title="Direct link to brute-forces--passwordusers-spray-1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crackmapexec-1"><strong>Crackmapexec</strong><a href="#crackmapexec-1" class="hash-link" aria-label="Direct link to crackmapexec-1" title="Direct link to crackmapexec-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#crackmapexe winram &lt;target-ip&gt; -u usrname.txt -p password.txt -X (powershell cmd) Get -MPrefences</code></td></tr><tr><td><img loading="lazy" alt="crackmapexec-winrm-scan" src="/journey/assets/images/winrmcrackmapexec-scan-f0a0d0563ef06192e867c166d2e2202e.png" width="2184" height="510" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rdp"><strong>RDP</strong><a href="#rdp" class="hash-link" aria-label="Direct link to rdp" title="Direct link to rdp">​</a></h2><ul><li>Remote Desktop Service</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what--why-remote-desktop-service-"><strong>What &amp; Why Remote Desktop Service ?</strong><a href="#what--why-remote-desktop-service-" class="hash-link" aria-label="Direct link to what--why-remote-desktop-service-" title="Direct link to what--why-remote-desktop-service-">​</a></h4><ul><li>The Remote Desktop Protocol (RDP) is a protocol developed by Microsoft for remote access to a computer running the Windows operating system. This protocol allows display and control commands to be transmitted via the GUI encrypted over IP networks.</li><li>Works on port 3389</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification-and-scans"><strong>Identification and Scans</strong><a href="#identification-and-scans" class="hash-link" aria-label="Direct link to identification-and-scans" title="Direct link to identification-and-scans">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-2"><strong>Nmap</strong><a href="#nmap-2" class="hash-link" aria-label="Direct link to nmap-2" title="Direct link to nmap-2">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># Nmap -sV -p 3389 target ip</code></td></tr><tr><td><img loading="lazy" alt="rdp-nmap-scan" src="/journey/assets/images/rdp-nmap-scan-1cc5664f5b98fbae60aff46cd8e7beeb.png" width="2184" height="646" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-rdp"><strong>Enumeration RDP</strong><a href="#enumeration-rdp" class="hash-link" aria-label="Direct link to enumeration-rdp" title="Direct link to enumeration-rdp">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-1"><strong>NSE Nmap</strong><a href="#nse-nmap-1" class="hash-link" aria-label="Direct link to nse-nmap-1" title="Direct link to nse-nmap-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#nmap -Pn -sV --version-intensity=5 -p T:3389 --script=xxxx &lt;IP&gt;</code></td></tr><tr><td><code>#nmap -sV -sC  -p3389 --script rdp*</code></td></tr><tr><td><code>nmap -sV -sC  -p3389 --packet-trace --disable-arp-ping –n</code></td></tr><tr><td><img loading="lazy" alt="rdp-nmap-script" src="/journey/assets/images/rdp-nmap-script-84b352f3595c3efa7df7b207cb691db8.png" width="2184" height="1190" class="img_ev3q"></td></tr><tr><td><strong>Wiresharks</strong></td></tr><tr><td><img loading="lazy" alt="rdp-nmap-script-wireshark" src="/journey/assets/images/nmap-scan-wireshark-4256b5512891a20afae2aee6f65cb807.png" width="975" height="375" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force--userspassword-spray"><strong>Brute Force &amp; Users/Password Spray</strong><a href="#brute-force--userspassword-spray" class="hash-link" aria-label="Direct link to brute-force--userspassword-spray" title="Direct link to brute-force--userspassword-spray">​</a></h3><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><strong>Using ncrack for one user</strong></td></tr><tr><td><code>ncrack -vv -u username -P passwords.txt rdp://IP</code></td></tr><tr><td><strong>Using ncrack for several users</strong></td></tr><tr><td><code>ncrack -vv -U users.txt -P passwords.txt rdp://IP</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hydra-1"><strong>Hydra</strong><a href="#hydra-1" class="hash-link" aria-label="Direct link to hydra-1" title="Direct link to hydra-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>hydra -L user.list -P password.list rdp://&lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="rdp-hydra-scan" src="/journey/assets/images/rdp-hydra-scan-e5accd16bcb6e2d4ef450c72a755f828.png" width="2184" height="872" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="discovery"><strong>Discovery</strong><a href="#discovery" class="hash-link" aria-label="Direct link to discovery" title="Direct link to discovery">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xfreerdp"><strong>Xfreerdp</strong><a href="#xfreerdp" class="hash-link" aria-label="Direct link to xfreerdp" title="Direct link to xfreerdp">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><img loading="lazy" alt="xfreerdp1" src="/journey/assets/images/xfreerdp1-5aa6487beaeec2f301beb5cc36bde1cd.png" width="975" height="766" class="img_ev3q"></td></tr><tr><td><img loading="lazy" alt="xfreerdp2" src="/journey/assets/images/xfreerdp2-13e455b74e3ef7b31ef4834450511ef2.png" width="975" height="614" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smtp"><strong>SMTP</strong><a href="#smtp" class="hash-link" aria-label="Direct link to smtp" title="Direct link to smtp">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-smtp"><strong>What is SMTP?</strong><a href="#what-is-smtp" class="hash-link" aria-label="Direct link to what-is-smtp" title="Direct link to what-is-smtp">​</a></h4><p><strong>SMTP (Simple Mail Transfer Protocol)</strong> is a TCP/IP protocol designed for the transmission of electronic mail (e-mail) between computers. It serves as a communication channel for sending and receiving emails. Typically, SMTP is used in conjunction with other protocols such as POP3 or IMAP, which enable users to store messages in a server mailbox and download them as needed. This combination of protocols is often referred to as a &quot;mail system.&quot;</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-smtp-works"><strong>How SMTP Works</strong><a href="#how-smtp-works" class="hash-link" aria-label="Direct link to how-smtp-works" title="Direct link to how-smtp-works">​</a></h4><p>SMTP operates as a client-server-based protocol, facilitating the sending and fetching of emails. Users employ email programs that utilize SMTP for sending messages and either POP3 or IMAP for receiving them. SMTP servers commonly operate on ports 25, 465, or 587. Key functions of an SMTP server include spam prevention through authentication and authorization of legitimate users to send emails. Many SMTP servers also support the Extended Simple Mail Transfer Protocol (ESMTP) with SMTP-Auth.</p><ol><li><p><strong>Sending an Email:</strong></p><ul><li>The SMTP client (Mail User Agent or MUA) converts the email into a header and a body.</li><li>The client uploads both the header and body to the SMTP server.</li></ul></li><li><p><strong>Server Processing:</strong></p><ul><li>The SMTP server, acting as a Mail Transfer Agent (MTA), checks the email for size and spam.</li><li>A Mail Submission Agent (MSA) may validate the email&#x27;s content before the MTA, ensuring authenticity and origin.</li></ul></li><li><p><strong>Mail Submission and Transfer:</strong></p><ul><li>The MSA/MTA processes can be compared to a post office and are hosted on servers.</li><li>The processed email is sent to the recipient&#x27;s Mail User Agent (MUA) via POP3 or IMAP.</li></ul></li><li><p><strong>Receiving Email:</strong></p><ul><li>With POP3, the email is deleted from the server once received.</li><li>IMAP stores the original email on the server and sends a copy to the client&#x27;s mailbox.</li></ul></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smtp-vs-pop-vs-imap"><strong>SMTP vs. POP vs. IMAP</strong><a href="#smtp-vs-pop-vs-imap" class="hash-link" aria-label="Direct link to smtp-vs-pop-vs-imap" title="Direct link to smtp-vs-pop-vs-imap">​</a></h4><table><thead><tr><th>Protocol</th><th>Description</th><th>Function</th><th>Port No</th><th>Default Port No (SSL)</th></tr></thead><tbody><tr><td>SMTP</td><td>Simple Mail Transfer Protocol</td><td>Send Mail (Push Mail)</td><td>25</td><td>N/A</td></tr><tr><td>POP</td><td>Post Office Protocol</td><td>Retrieve Mail (POP Mail)</td><td>110</td><td>995</td></tr><tr><td>IMAP</td><td>Internet Message Access Protocol</td><td>Retrieve Mail (IMAP Mail)</td><td>143</td><td>993</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="commands-in-smtp"><strong>Commands in SMTP</strong><a href="#commands-in-smtp" class="hash-link" aria-label="Direct link to commands-in-smtp" title="Direct link to commands-in-smtp">​</a></h4><ul><li><strong>AUTH PLAIN:</strong> Used for client authentication.</li><li><strong>HELO:</strong> The client logs in with its computer name to start the session.</li><li><strong>MAIL FROM:</strong> The client specifies the email sender.</li><li><strong>RCPT TO:</strong> The client specifies the email recipient.</li><li><strong>DATA:</strong> Initiates the transmission of the email.</li><li><strong>RSET:</strong> The client aborts the initiated transmission but maintains the connection.</li><li><strong>VRFY:</strong> Checks if a mailbox is available for message transfer.</li><li><strong>EXPN:</strong> Similar to VRFY, it checks if a mailbox is available for messaging.</li><li><strong>NOOP:</strong> Requests a server response to prevent disconnection due to timeout.</li><li><strong>QUIT:</strong> Terminates the session.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scans"><strong>Identification &amp; Scans</strong><a href="#identification--scans" class="hash-link" aria-label="Direct link to identification--scans" title="Direct link to identification--scans">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dig"><strong>DIG</strong><a href="#dig" class="hash-link" aria-label="Direct link to dig" title="Direct link to dig">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># dig +short mx google.com</code></td></tr><tr><td><img loading="lazy" alt="smtp-dig" src="/journey/assets/images/smtp-dig-960e1e4df9edb285c82e17e0531fcbc9.png" width="2184" height="600" class="img_ev3q"></td></tr><tr><td>You can connect to an SMTP server with netcat and run the VRFY command to check if email addresses are valid. You can also check mailing list membership with EXPN.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-3"><strong>Nmap</strong><a href="#nmap-3" class="hash-link" aria-label="Direct link to nmap-3" title="Direct link to nmap-3">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># Nmap –Pn –n –Sv –p 25 &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="smtp-nmap-scan" src="/journey/assets/images/smtp-nmap-scan-4cb2b139635d94c8ab7befaa7efe92f8.png" width="2184" height="1598" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="telnet"><strong>Telnet</strong><a href="#telnet" class="hash-link" aria-label="Direct link to telnet" title="Direct link to telnet">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>Telent &lt;Target-IP&gt; &lt;Port&gt;</code></td></tr><tr><td><img loading="lazy" alt="smtp-telnet" src="/journey/assets/images/smtp-telnet-9cc5075bf6b79e4a60fe484e19ce0f67.png" width="2184" height="464" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-smtp"><strong>Enumeration SMTP</strong><a href="#enumeration-smtp" class="hash-link" aria-label="Direct link to enumeration-smtp" title="Direct link to enumeration-smtp">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-2"><strong>NSE Nmap</strong><a href="#nse-nmap-2" class="hash-link" aria-label="Direct link to nse-nmap-2" title="Direct link to nse-nmap-2">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#nmap -Pn -n -p 25 --script=smtp-*  &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="smtp-nmap-scan-script" src="/journey/assets/images/smtp-namp-scan-script-da1e3d27807e3f90d31a65f3dfc50610.png" width="2184" height="1008" class="img_ev3q"></td></tr><tr><td><strong>Wireshark</strong></td></tr><tr><td><img loading="lazy" alt="smtp-namp-script-wireshark" src="/journey/assets/images/smtp-nmap-scan-wireshark-d1b88f9eed07c300ed1342dc8942ab72.png" width="750" height="345" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force--usespassword-spray"><strong>Brute Force &amp; Uses/Password Spray</strong><a href="#brute-force--usespassword-spray" class="hash-link" aria-label="Direct link to brute-force--usespassword-spray" title="Direct link to brute-force--usespassword-spray">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hydra-2"><strong>Hydra</strong><a href="#hydra-2" class="hash-link" aria-label="Direct link to hydra-2" title="Direct link to hydra-2">​</a></h3><p>|<strong>Syntax &amp; Commands</strong>|
|<code># hydra -L users.txt TARGET-IP smtp-enum</code>|
|<img loading="lazy" alt="smtp-hydra-scan" src="/journey/assets/images/smtp-hydra-scan-2c90f9661f0f4f5a892d6d6c0bd5e4b3.png" width="2184" height="736" class="img_ev3q">|</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-sql-server-mssql"><strong>Microsoft SQL Server (MSSQL)</strong><a href="#microsoft-sql-server-mssql" class="hash-link" aria-label="Direct link to microsoft-sql-server-mssql" title="Direct link to microsoft-sql-server-mssql">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-mssql"><strong>What is MSSQL?</strong><a href="#what-is-mssql" class="hash-link" aria-label="Direct link to what-is-mssql" title="Direct link to what-is-mssql">​</a></h4><p><strong>Microsoft SQL Server</strong> is a robust relational database management system (RDBMS) developed by Microsoft. As a database server, it serves as a software product with the primary function of storing and retrieving data as requested by various software applications. These applications can run either on the same computer where MSSQL is installed or on other computers across a network, including the Internet.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-features"><strong>Key Features:</strong><a href="#key-features" class="hash-link" aria-label="Direct link to key-features" title="Direct link to key-features">​</a></h4><ul><li><p><strong>Database Management:</strong> MSSQL is designed for efficiently managing databases, ensuring data integrity, and providing secure access to stored data.</p></li><li><p><strong>Query Language:</strong> It employs a powerful backend language to handle queries and data manipulation tasks. SQL (Structured Query Language) is commonly used for interacting with MSSQL databases.</p></li><li><p><strong>Networking Capabilities:</strong> MSSQL enables communication between client applications and the database server over a network.</p></li><li><p><strong>Instances:</strong> A server running MSSQL can host multiple instances on high ports, allowing for the management of distinct databases.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="port-usage"><strong>Port Usage</strong>:<a href="#port-usage" class="hash-link" aria-label="Direct link to port-usage" title="Direct link to port-usage">​</a></h4><ul><li><p><strong>Port 1433:</strong> Used by clients to interact with the MSSQL database. This port is crucial for communication and executing queries.</p></li><li><p><strong>Port 1434:</strong> Used for listing available instances. A server running MSSQL can have multiple instances, each potentially on a different high port.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations"><strong>Security Considerations:</strong><a href="#security-considerations" class="hash-link" aria-label="Direct link to security-considerations" title="Direct link to security-considerations">​</a></h4><ul><li><p><strong>Default Credentials:</strong> MSSQL installations often come with default credentials, and the commonly used ones include <code>sa:sa</code> where <code>sa</code> stands for Sysadmin or system admin. It is crucial to change these defaults to enhance security.</p></li><li><p><strong>Authentication:</strong> MSSQL provides various authentication mechanisms to control access, and it&#x27;s recommended to use strong authentication methods to protect sensitive data.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-mssql"><strong>Why MSSQL?</strong><a href="#why-mssql" class="hash-link" aria-label="Direct link to why-mssql" title="Direct link to why-mssql">​</a></h4><ul><li><p><strong>Reliability:</strong> MSSQL is known for its reliability, providing robust mechanisms for data storage, backup, and recovery.</p></li><li><p><strong>Scalability:</strong> It offers scalability options, allowing organizations to scale their databases as their data storage needs grow.</p></li><li><p><strong>Integration with Microsoft Ecosystem:</strong> For organizations using other Microsoft products and technologies, MSSQL seamlessly integrates with the Microsoft ecosystem.</p></li><li><p><strong>Security:</strong> MSSQL provides security features to protect data and control access, including encryption and authentication mechanisms.</p></li><li><p><strong>Enterprise-Level Support:</strong> Microsoft offers comprehensive support for MSSQL, making it suitable for enterprise-level applications.</p></li></ul><p>For more in-depth details, please refer to the official <a href="https://www.microsoft.com/en-us/sql-server" target="_blank" rel="noopener noreferrer">Microsoft SQL Server website</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scans-1"><strong>Identification &amp; Scans</strong><a href="#identification--scans-1" class="hash-link" aria-label="Direct link to identification--scans-1" title="Direct link to identification--scans-1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-4"><strong>Nmap</strong><a href="#nmap-4" class="hash-link" aria-label="Direct link to nmap-4" title="Direct link to nmap-4">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># Nmap -n -Sv -Pn -p 1433,1434 Target-IP</code></td></tr><tr><td><img loading="lazy" alt="mssql-nmap-scan" src="/journey/assets/images/mssql-nmap-scan-5da2a2cb1977de64e5dc03fa7f46f57d.png" width="2184" height="1280" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-mssql"><strong>Enumeration MSSQL</strong><a href="#enumeration-mssql" class="hash-link" aria-label="Direct link to enumeration-mssql" title="Direct link to enumeration-mssql">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-3"><strong>NSE Nmap</strong><a href="#nse-nmap-3" class="hash-link" aria-label="Direct link to nse-nmap-3" title="Direct link to nse-nmap-3">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># nmap -n -Pn --script=mysql-*  &lt;Target-IP&gt;</code></td></tr><tr><td><img loading="lazy" alt="mssql-nmap-script" src="/journey/assets/images/mssql-nmap-script-3a35b3ffc564de0614d5ec5b4e9e5ce0.png" width="2184" height="2142" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force--usespassword-spray-1"><strong>Brute Force &amp; Uses/Password Spray</strong><a href="#brute-force--usespassword-spray-1" class="hash-link" aria-label="Direct link to brute-force--usespassword-spray-1" title="Direct link to brute-force--usespassword-spray-1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="medusa"><strong>Medusa</strong><a href="#medusa" class="hash-link" aria-label="Direct link to medusa" title="Direct link to medusa">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># medusa -h &lt;Target-IP&gt; -u &#x27;username/username.txt&#x27; -p &#x27;password/password.txt&#x27; -M mysql</code></td></tr><tr><td><img loading="lazy" alt="mssql-medusa" src="/journey/assets/images/mssql-medusa-5a56fe507629ac8c679e239d48bd2a5a.png" width="2184" height="510" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="impacket"><strong>Impacket</strong><a href="#impacket" class="hash-link" aria-label="Direct link to impacket" title="Direct link to impacket">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>impacket-mssqlclient -port 1433 DOMAIN/username:password@&lt;target-ip&gt;</code></td></tr><tr><td><code>impacket-mssqlclient -port 1433 DOMAIN/username:password@&lt;target-ip&gt; -windows-auth</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sqsh"><strong>Sqsh</strong><a href="#sqsh" class="hash-link" aria-label="Direct link to sqsh" title="Direct link to sqsh">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>sqsh -S &lt;target-ip&gt; -U username -P password</code></td></tr><tr><td><code>sqsh -S &lt;target-ip&gt; -U username -P password -D database</code></td></tr><tr><td><code># Get all users</code></td></tr><tr><td><code>&gt; SELECT * FROM sys.database</code></td></tr><tr><td><code># Switch to the database</code></td></tr><tr><td><code>&gt; USE &lt;database&gt;</code></td></tr><tr><td><code># Get databases</code></td></tr><tr><td><code>&gt; SELECT * FROM master.dbo.sysdatabases</code></td></tr><tr><td><img loading="lazy" alt="mssql-login" src="/journey/assets/images/mssql-login-316e29cded16bc4d09fee5ca62967bf3.png" width="1022" height="609" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mysql"><strong>MySQL</strong><a href="#mysql" class="hash-link" aria-label="Direct link to mysql" title="Direct link to mysql">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-mysql"><strong>What is MySQL?</strong><a href="#what-is-mysql" class="hash-link" aria-label="Direct link to what-is-mysql" title="Direct link to what-is-mysql">​</a></h4><p><strong>MySQL</strong> is an open-source SQL (Structured Query Language) relational database management system (RDBMS) developed and supported by Oracle. In the context of databases, MySQL serves as a structured and organized collection of data designed for easy storage, retrieval, and management.</p><ul><li>MSSQL===&gt; open source==&gt; if you are performing an attack in a small org, or someone who have limited scope . Can assume that the application could be MSQL Because they are already tired with the budget</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-features-1"><strong>Key Features:</strong><a href="#key-features-1" class="hash-link" aria-label="Direct link to key-features-1" title="Direct link to key-features-1">​</a></h4><ul><li><p><strong>Open Source:</strong> MySQL is an open-source database system, making its source code accessible to the public and allowing users to modify and distribute it freely.</p></li><li><p><strong>SQL:</strong> SQL is the primary language used to interact with MySQL databases. It provides a standardized way to query and manipulate data in relational databases.</p></li><li><p><strong>Portability:</strong> MySQL is a cross-platform database system, meaning it can run on various operating systems such as Windows, Linux, and macOS.</p></li><li><p><strong>Community Support:</strong> Being open source, MySQL has a large and active community of developers and users who contribute to its development, offer support, and share knowledge.</p></li><li><p><strong>Scalability:</strong> MySQL is scalable, making it suitable for both small-scale applications and large-scale enterprise solutions.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mysql-in-comparison-to-mssql"><strong>MySQL in Comparison to MSSQL:</strong><a href="#mysql-in-comparison-to-mssql" class="hash-link" aria-label="Direct link to mysql-in-comparison-to-mssql" title="Direct link to mysql-in-comparison-to-mssql">​</a></h4><ul><li><p><strong>Open Source vs. Commercial:</strong> MySQL is open source, while MSSQL (Microsoft SQL Server) is a commercial database management system.</p></li><li><p><strong>Port Number:</strong> MySQL commonly uses port number 3306 for communication.</p></li><li><p><strong>Installation:</strong> MySQL can be installed on various operating systems using commands like <code>sudo apt install mysql-server -y</code> for Ubuntu-based systems.</p></li><li><p><strong>Language:</strong> MySQL, like MSSQL, is based on SQL, providing a standardized language for database interactions.</p></li><li><p><strong>Communication Model:</strong> MySQL uses a client-server communication model, where client applications interact with the MySQL server to execute queries and manage data.</p></li><li><p><strong>Workflow:</strong> MySQL is typically used as a backend database, handling the storage, retrieval, and management of data on the server side.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-mysql"><strong>Why MySQL?</strong><a href="#why-mysql" class="hash-link" aria-label="Direct link to why-mysql" title="Direct link to why-mysql">​</a></h4><ul><li><p><strong>Open Source Advantage:</strong> Being open source, MySQL is cost-effective and well-suited for organizations with budget constraints.</p></li><li><p><strong>Community Support:</strong> The active community around MySQL ensures ongoing support, updates, and a wealth of resources for users.</p></li><li><p><strong>Compatibility:</strong> MySQL is compatible with various programming languages, making it versatile for developers working in different environments.</p></li><li><p><strong>Scalability and Performance:</strong> MySQL&#x27;s scalability and performance make it suitable for a wide range of applications, from small projects to large-scale enterprise systems.</p></li><li><p><strong>Reliability:</strong> MySQL is known for its reliability, data integrity, and robust features, making it a trusted choice for many developers and organizations.</p></li></ul><p>For more detailed information and resources, visit the official <a href="https://www.mysql.com/" target="_blank" rel="noopener noreferrer">MySQL website</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scans-2"><strong>Identification &amp; Scans</strong><a href="#identification--scans-2" class="hash-link" aria-label="Direct link to identification--scans-2" title="Direct link to identification--scans-2">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-5"><strong>Nmap</strong><a href="#nmap-5" class="hash-link" aria-label="Direct link to nmap-5" title="Direct link to nmap-5">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># nmap -sV -p 3306 target-ip</code></td></tr><tr><td><img loading="lazy" alt="mysql-nmap-scan" src="/journey/assets/images/mysql-nmap-scan-789abf9b12c6f8b3be10fbc9de304c09.png" width="2184" height="646" class="img_ev3q"></td></tr><tr><td><strong>Wireshark</strong></td></tr><tr><td><img loading="lazy" alt="mysql-nmap-scan-wireshark" src="/journey/assets/images/mysql-nmap-scan-wireshark-dd5342a2313b290a3c3e1b6dcb557492.png" width="750" height="352" class="img_ev3q"></td></tr><tr><td>Got and ACK packet that who nmap knows the port is open.</td></tr><tr><td>Closed Ports/Filtered Ports</td></tr><tr><td><img loading="lazy" alt="mysql-nmap-scan-2" src="/journey/assets/images/mysql-nmap-scan-2-158a8a6a990365b449f7bdbbec5cd78a.png" width="2184" height="646" class="img_ev3q"></td></tr><tr><td>The ball/packet nmap send did not return do nmap assume the port is closed/filtered.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-mysql"><strong>Enumeration MYSQL</strong><a href="#enumeration-mysql" class="hash-link" aria-label="Direct link to enumeration-mysql" title="Direct link to enumeration-mysql">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-4"><strong>NSE Nmap</strong><a href="#nse-nmap-4" class="hash-link" aria-label="Direct link to nse-nmap-4" title="Direct link to nse-nmap-4">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands for mysql-info</strong></th></tr></thead><tbody><tr><td><code># nmap -Pn -n -p 3306 --script=mysql-info.nse &lt;tarhet-ip&gt;</code></td></tr><tr><td><img loading="lazy" alt="mysql-nmap-script" src="/journey/assets/images/mysql-nmap-script-7ad4803a862a7524a6cc5a3498e710a9.png" width="2184" height="1100" class="img_ev3q"></td></tr><tr><td><strong>Wireshark</strong></td></tr><tr><td><img loading="lazy" alt="mysql-nmap-scan-script" src="/journey/assets/images/mysql-nmap-script-wireshark-60ab682f8129616baec9ae4f946d3470.png" width="750" height="370" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-5"><strong>NSE Nmap</strong><a href="#nse-nmap-5" class="hash-link" aria-label="Direct link to nse-nmap-5" title="Direct link to nse-nmap-5">​</a></h3><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># nmap -Pn -n -p 3306 --script=mysql-* &lt;target-ip&gt;</code></td></tr><tr><td><img loading="lazy" alt="mysql-nmap-scan-script-2" src="/journey/assets/images/mysql-nmap-scan-script-2-543dd21058b63915b43c685f7fcdc334.png" width="2184" height="1462" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force--userspassword-spray-1"><strong>Brute Force &amp; Users/Password Spray</strong><a href="#brute-force--userspassword-spray-1" class="hash-link" aria-label="Direct link to brute-force--userspassword-spray-1" title="Direct link to brute-force--userspassword-spray-1">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hydra-3"><strong>Hydra</strong><a href="#hydra-3" class="hash-link" aria-label="Direct link to hydra-3" title="Direct link to hydra-3">​</a></h4><ul><li>If the NSE scripts / other enum finds database users, bruteforce password with hydra</li></ul><table><thead><tr><th><strong>Syntax  &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#sudo hydra -l root -P /usr/share/wordlist mysql://target</code></td></tr><tr><td><img loading="lazy" alt="mysql-hydra" src="/journey/assets/images/mysql-hydra-1ed304a81e2bc30e3b6d643158a3340f.png" width="2184" height="692" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="medusa-1"><strong>Medusa</strong><a href="#medusa-1" class="hash-link" aria-label="Direct link to medusa-1" title="Direct link to medusa-1">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code># medusa -h [Target-IP] -u username -P password.txt -t -M mysql</code></td></tr><tr><td><img loading="lazy" alt="mysql-medusa" src="/journey/assets/images/mysql-medusa-c0b9dd22d61fb11c17cd3914cfbd7105.png" width="2184" height="556" class="img_ev3q"></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="discovery-1"><strong>Discovery</strong><a href="#discovery-1" class="hash-link" aria-label="Direct link to discovery-1" title="Direct link to discovery-1">​</a></h3><table><thead><tr><th><strong>Discovery</strong></th><th><strong>Command</strong></th></tr></thead><tbody><tr><td><strong>Try Connection from Outside</strong></td><td><code>mysql --host &lt;IP&gt; -u root -p root</code></td></tr><tr><td><strong>Connection from the Target Machine</strong></td><td><code>mysql -u root -p root database</code></td></tr><tr><td><strong>Classical Commands</strong></td><td></td></tr><tr><td>Show existing databases</td><td><code>show databases;</code></td></tr><tr><td>Use a specific database</td><td><code>use database_name;</code></td></tr><tr><td>Show tables in the current database</td><td><code>show tables;</code></td></tr><tr><td>Describe the structure of a table</td><td><code>describe table_name;</code></td></tr><tr><td>View user details in MySQL</td><td><code>select host, user, password from mysql.user;</code></td></tr><tr><td><strong>Local Access / Remote Access</strong></td><td></td></tr><tr><td>Connect to MySQL as root</td><td><code>mysql -u root</code></td></tr><tr><td>For remote access</td><td><code>mysql -u root -p</code></td></tr><tr><td></td><td><em>(A password will be asked. Always test root:root credentials)</em></td></tr></tbody></table><table><thead><tr><th><img loading="lazy" alt="mysql-login-2" src="/journey/assets/images/mysql-login-2-69812bc8541f0612064a12146ba5b694.png" width="2184" height="2506" class="img_ev3q"></th></tr></thead></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nfs"><strong>NFS</strong><a href="#nfs" class="hash-link" aria-label="Direct link to nfs" title="Direct link to nfs">​</a></h2><table><thead><tr><th><strong>NFS</strong></th><th></th></tr></thead><tbody><tr><td><strong>What is NFS?</strong></td><td>Network File System</td></tr><tr><td><strong>Development Year</strong></td><td>1984</td></tr><tr><td><strong>Developed by</strong></td><td>Sun Microsystems</td></tr><tr><td><strong>Similar to</strong></td><td>SMB (Server Message Block)</td></tr><tr><td><strong>Guest Sessions</strong></td><td>Available (similar to SMB)</td></tr><tr><td><strong>NFS Ports</strong></td><td>111 (TCP/UDP) - Data transfer &amp; validation</td></tr><tr><td></td><td>2049 (TCP/UDP) - Default</td></tr><tr><td><strong>Authentication/Authorization</strong></td><td>No mechanism for authentication or authorization</td></tr><tr><td><strong>Cross-Platform Sharing</strong></td><td>Windows NFS server shares files with Linux &amp; MacOS</td></tr><tr><td><strong>NFS Acronym</strong></td><td>Network File System</td></tr><tr><td><strong>NFS Client Interaction</strong></td><td>Mounting (Process that allows an NFS client to interact with a remote directory as if it were a physical device)</td></tr><tr><td><strong>Representation of Files/Directories on Server</strong></td><td>File handle</td></tr><tr><td><strong>Communication Protocol</strong></td><td>RPC (Remote Procedure Call)</td></tr><tr><td><strong>Latest Version</strong></td><td>NFSv4.2</td></tr><tr><td><strong>NFS Versions</strong></td><td></td></tr><tr><td>NFSv2</td><td>Older version, supported by many systems, operated entirely over UDP</td></tr><tr><td>NFSv3</td><td>More features, including variable file size and better error reporting, not fully compatible with NFSv2 clients</td></tr><tr><td>NFSv4</td><td>Includes Kerberos, works through firewalls and on the Internet, no longer requires portmappers, supports ACLs, applies state-based operations, provides performance improvements and high security. The first version to have a stateful protocol.</td></tr><tr><td><strong>More Details</strong></td><td>Available on the website</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scans-3"><strong>Identification &amp; Scans</strong><a href="#identification--scans-3" class="hash-link" aria-label="Direct link to identification--scans-3" title="Direct link to identification--scans-3">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nmap-6"><strong>Nmap</strong><a href="#nmap-6" class="hash-link" aria-label="Direct link to nmap-6" title="Direct link to nmap-6">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>Nmap –n -Pn -v -p 111,2049 Target-IP</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rpcinfo"><strong>rpcinfo</strong><a href="#rpcinfo" class="hash-link" aria-label="Direct link to rpcinfo" title="Direct link to rpcinfo">​</a></h4><p>|<strong>Syntax &amp; Commands</strong>|
|<code>rpcinfo -p &lt;ip&gt;</code>|</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-nfs"><strong>Enumeration NFS</strong><a href="#enumeration-nfs" class="hash-link" aria-label="Direct link to enumeration-nfs" title="Direct link to enumeration-nfs">​</a></h3><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>nmap -sV -p 111 --script=rpcinfo &lt;target-ip&gt;</code></td></tr><tr><td><code>nmap -p 111 --script nfs* &lt;target-ip&gt;</code></td></tr><tr><td><img loading="lazy" alt="nfs-nmap-scan-script" src="/journey/assets/images/nfs-nmap-script-e5f6d59f8e4dcad39899281112b4b463.png" width="2184" height="1508" class="img_ev3q"></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="show-all-mounts"><strong>Show all mounts</strong><a href="#show-all-mounts" class="hash-link" aria-label="Direct link to show-all-mounts" title="Direct link to show-all-mounts">​</a></h4><ul><li>If nfs is available, use showmount to view available mounting points</li><li>There is nfs share available or not but its shows/works on the subnets basis</li><li>To know which folder has the server available to mount you an ask it using:</li></ul><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#Showmount -e target</code></td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──(root㉿Kali-Linux-full)-[/home/hasanrehni/credentails]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─# showmount -e 192.168.100.130            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export list for 192.168.100.130:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/mnt/nfs_share *</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th><img loading="lazy" alt="nfs-showmunt-wireshark" src="/journey/assets/images/nfs-showmount-wireshark-6e821e88fc7b110283dc4892813207c3.png" width="975" height="491" class="img_ev3q"></th></tr></thead></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mounting-the-share"><strong>Mounting the Share</strong><a href="#mounting-the-share" class="hash-link" aria-label="Direct link to mounting-the-share" title="Direct link to mounting-the-share">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a directory for mounting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /mnt/new_back</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mount the NFS share (version 2) with nolock option</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> -t nfs -o </span><span class="token assign-left variable" style="color:#36acaa">vers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.12</span><span class="token plain">.0.150:/backup /mnt/new_back -o nolock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create the directory for mounting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /mnt/nfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mount the NFS share</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> -t nfs </span><span class="token variable" style="color:#36acaa">$ip</span><span class="token plain">:/share /mnt/nfs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Mounting an NFS share</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">root㉿Kali-Linux-full</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">/home/hasanrehni</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─</span><span class="token comment" style="color:#999988;font-style:italic"># mount -t nfs 192.168.100.130:/mnt/nfs_share /home/hasanrehni/mntdir</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Created symlink for systemd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Created symlink /run/systemd/system/remote-fs.target.wants/rpc-statd.service → /lib/systemd/system/rpc-statd.service.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Explanation:</p><ul><li><code>mkdir /mnt/new_back</code>: Creates a directory named &quot;new_back&quot; in the &quot;/mnt&quot; directory.</li><li><code>mount -t nfs -o vers=2 10.12.0.150:/backup /mnt/new_back -o nolock</code>: Mounts an NFS share from IP address &quot;10.12.0.150&quot; at the &quot;/backup&quot; directory to the local directory &quot;/mnt/new_back&quot; using NFS version 2 and the &quot;nolock&quot; option.</li><li><code>mkdir /mnt/nfs</code>: Creates a directory named &quot;nfs&quot; in the &quot;/mnt&quot; directory.</li><li><code>mount -t nfs $ip:/share /mnt/nfs</code>: Mounts an NFS share from the specified IP address and directory to the local directory &quot;/mnt/nfs&quot;.</li><li><code>mount -t nfs 192.168.100.130:/mnt/nfs_share /home/hasanrehni/mntdir</code>: Example command to mount an NFS share from IP address &quot;192.168.100.130&quot; at the &quot;/mnt/nfs_share&quot; directory to the local directory &quot;/home/hasanrehni/mntdir&quot;.</li></ul><p>Certainly! Here&#x27;s the information in a formatted manner:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-secure-shell"><strong>SSH (Secure Shell)</strong><a href="#ssh-secure-shell" class="hash-link" aria-label="Direct link to ssh-secure-shell" title="Direct link to ssh-secure-shell">​</a></h3><p><strong>What is SSH?</strong>
Secure Shell (SSH) is a Command Line Interface (CLI) that provides similar services to Telnet but in a secure manner. Unlike Telnet, SSH encrypts the communication between the client and the server, providing a more secure method of remote access.</p><p><strong>Key Features:</strong></p><ul><li><strong>Public Key &amp; Private Key:</strong> SSH uses a pair of cryptographic keys, a public key, and a private key. Both parties share their public keys, and communication is encrypted using each other&#x27;s public keys, which can only be decrypted by their corresponding private keys.</li><li><strong>Port Number:</strong> SSH operates on Port 22.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identification--scans-4"><strong>Identification &amp; Scans</strong><a href="#identification--scans-4" class="hash-link" aria-label="Direct link to identification--scans-4" title="Direct link to identification--scans-4">​</a></h3><p><strong>Nmap:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Nmap Scan for Port 22 (SSH)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Nmap Scan Output:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Starting Nmap </span><span class="token number" style="color:#36acaa">7.94</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> https://nmap.org </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">2023</span><span class="token plain">-07-12 </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:35 IST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap scan report </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host is up </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.00092s latency</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain">/tcp </span><span class="token function" style="color:#d73a49">open</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nmap done: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> IP address </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> up</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> scanned </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.07</span><span class="token plain"> seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Explanation:</p><ul><li><code>nmap -n -Pn -p 22 192.168.50.124</code>: Initiates an Nmap scan to check the status of Port 22 (SSH) on the IP address &quot;192.168.50.124&quot;.</li></ul><p>Certainly! Here&#x27;s the information in a formatted manner:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumeration-for-ssh"><strong>Enumeration for SSH</strong><a href="#enumeration-for-ssh" class="hash-link" aria-label="Direct link to enumeration-for-ssh" title="Direct link to enumeration-for-ssh">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nse-nmap-scripting-engine-scans"><strong>NSE (Nmap Scripting Engine) Scans</strong><a href="#nse-nmap-scripting-engine-scans" class="hash-link" aria-label="Direct link to nse-nmap-scripting-engine-scans" title="Direct link to nse-nmap-scripting-engine-scans">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-check-ssh-public-key-acceptance">1. Check SSH Public Key Acceptance<a href="#1-check-ssh-public-key-acceptance" class="hash-link" aria-label="Direct link to 1. Check SSH Public Key Acceptance" title="Direct link to 1. Check SSH Public Key Acceptance">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> --script</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ssh-publickey-acceptance.nse  </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-check-sshv1">2. Check SSHv1<a href="#2-check-sshv1" class="hash-link" aria-label="Direct link to 2. Check SSHv1" title="Direct link to 2. Check SSHv1">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> --script</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sshv1.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-check-ssh-host-key">3. Check SSH Host Key<a href="#3-check-ssh-host-key" class="hash-link" aria-label="Direct link to 3. Check SSH Host Key" title="Direct link to 3. Check SSH Host Key">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> --script</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ssh-hostkey.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>SSH Host Key Output:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain">/tcp </span><span class="token function" style="color:#d73a49">open</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ssh-hostkey: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"> db:a0:f9:fe:d5:d4:b8:cb:c0:30:67:ce:f9:59:6a:da </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RSA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">256</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">74</span><span class="token plain">:a7:94:d6:8f:19:62:98:f1:24:37:2b:c1:6c:b9:5f </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ECDSA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_  </span><span class="token number" style="color:#36acaa">256</span><span class="token plain"> c2:e5:3b:e8:cf:8f:83:53:b0:6c:1b:47:65:05:c4:4a </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ED25519</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-check-ssh-run-authentication-methods">4. Check SSH Run (Authentication Methods)<a href="#4-check-ssh-run-authentication-methods" class="hash-link" aria-label="Direct link to 4. Check SSH Run (Authentication Methods)" title="Direct link to 4. Check SSH Run (Authentication Methods)">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> --script</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ssh-run.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>SSH Run Output (Failed without specifying credentials and command):</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain">/tcp </span><span class="token function" style="color:#d73a49">open</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_ssh-run: Failed to specify credentials and </span><span class="token builtin class-name">command</span><span class="token plain"> to run.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-check-ssh-authentication-methods">5. Check SSH Authentication Methods<a href="#5-check-ssh-authentication-methods" class="hash-link" aria-label="Direct link to 5. Check SSH Authentication Methods" title="Direct link to 5. Check SSH Authentication Methods">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmap -n -Pn -p </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> --script</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ssh-auth-methods.nse </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.50.124</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>SSH Authentication Methods Output:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token plain">/tcp </span><span class="token function" style="color:#d73a49">open</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ssh-auth-methods: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   Supported authentication methods: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">     publickey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">     password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_    keyboard-interactive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-information">Additional Information<a href="#additional-information" class="hash-link" aria-label="Direct link to Additional Information" title="Direct link to Additional Information">​</a></h3><ul><li>SSH operates on Port 22.</li><li>Nmap can be used to perform various SSH-related checks, including public key acceptance, SSHv1 support, host key enumeration, authentication methods, and more.</li><li>Ensure proper credentials and commands are provided when using specific scripts, as failure messages may occur without proper specification.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force--userspassword-spray-2"><strong>Brute Force &amp; Users/Password Spray</strong><a href="#brute-force--userspassword-spray-2" class="hash-link" aria-label="Direct link to brute-force--userspassword-spray-2" title="Direct link to brute-force--userspassword-spray-2">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hydra-4"><strong>Hydra</strong><a href="#hydra-4" class="hash-link" aria-label="Direct link to hydra-4" title="Direct link to hydra-4">​</a></h4><p>|<strong>Syntax &amp; Commands</strong>|
|<code>#Hydra –U username.txt -P password.txt ssh://Target-IP</code>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="medusa-2"><strong>Medusa</strong><a href="#medusa-2" class="hash-link" aria-label="Direct link to medusa-2" title="Direct link to medusa-2">​</a></h4><p>|<strong>Syntax &amp; Commands</strong>|
|<code>#medusa -h $ip -U user.txt -P pass.txt -M ssh</code>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ncrack"><strong>Ncrack</strong><a href="#ncrack" class="hash-link" aria-label="Direct link to ncrack" title="Direct link to ncrack">​</a></h4><table><thead><tr><th><strong>Syntax &amp; Commands</strong></th></tr></thead><tbody><tr><td><code>#ncrack –v –U user.txt –P pass.txt $ip:22</code></td></tr><tr><td><img loading="lazy" alt="ncark-ssh" src="/journey/assets/images/ssh-ncark-08aa99ab78da53731d05792eb0a21be6.png" width="2184" height="1008" class="img_ev3q"></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/journey/docs/CyberSecurity/CyberrSecurity360/The Craft of Network Scanning"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The Craft of Network Scanning</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/journey/docs/CyberSecurity/Palo Alto/Palo Alto Introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Palo Alto Introduction</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enumeration" class="table-of-contents__link toc-highlight">Enumeration</a><ul><li><a href="#what--why-enumeration" class="table-of-contents__link toc-highlight"><strong>What &amp; Why Enumeration?</strong></a></li></ul></li><li><a href="#services" class="table-of-contents__link toc-highlight"><strong>Services</strong></a><ul><li><a href="#what--why-service" class="table-of-contents__link toc-highlight"><strong>What &amp; Why Service?</strong></a></li></ul></li><li><a href="#service-enumeration" class="table-of-contents__link toc-highlight"><strong>Service Enumeration</strong></a><ul><li><a href="#what--why-service-enumeration" class="table-of-contents__link toc-highlight"><strong>What &amp; Why Service Enumeration?</strong></a></li></ul></li><li><a href="#smb-service" class="table-of-contents__link toc-highlight"><strong>SMB Service</strong></a><ul><li><a href="#what--why-smb" class="table-of-contents__link toc-highlight"><strong>What &amp; Why SMB?</strong></a></li></ul></li><li><a href="#identification--scan" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scan</strong></a></li><li><a href="#communication-between-two-windows-pcs" class="table-of-contents__link toc-highlight"><strong>Communication between Two Windows PCs</strong></a></li><li><a href="#smb-login-with-credentials--hashes" class="table-of-contents__link toc-highlight"><strong>SMB Login with Credentials &amp; Hashes</strong></a></li><li><a href="#nmap-scan" class="table-of-contents__link toc-highlight"><strong>Nmap Scan</strong></a></li><li><a href="#smb-enumeration" class="table-of-contents__link toc-highlight"><strong>SMB Enumeration</strong></a><ul><li><a href="#nse-nmap" class="table-of-contents__link toc-highlight"><strong>NSE Nmap</strong></a></li></ul></li><li><a href="#smb-enumeration-using-smbv2-scripts" class="table-of-contents__link toc-highlight"><strong>SMB Enumeration Using SMBv2 Scripts</strong></a><ul><li><a href="#enumeration-insights" class="table-of-contents__link toc-highlight"><strong>Enumeration Insights</strong></a></li></ul></li><li><a href="#guest-sessions-enumeration" class="table-of-contents__link toc-highlight"><strong>Guest Sessions Enumeration</strong></a><ul><li><a href="#what-are-guest-sessions" class="table-of-contents__link toc-highlight"><strong>What are Guest Sessions?</strong></a></li><li><a href="#why-use-guest-sessions" class="table-of-contents__link toc-highlight"><strong>Why Use Guest Sessions?</strong></a></li><li><a href="#count-sessions--guest-sessions" class="table-of-contents__link toc-highlight"><strong>Count Sessions / Guest Sessions</strong></a></li><li><a href="#smb-client-usage" class="table-of-contents__link toc-highlight"><strong>SMB Client Usage</strong></a></li></ul></li><li><a href="#null-sessions--enumeration" class="table-of-contents__link toc-highlight"><strong>Null Sessions  Enumeration</strong></a></li><li><a href="#ftp" class="table-of-contents__link toc-highlight"><strong>FTP</strong></a><ul><li><a href="#what--why-ftp" class="table-of-contents__link toc-highlight"><strong>What &amp; Why FTP</strong></a></li><li><a href="#identification--scan-1" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scan</strong></a></li><li><a href="#enumerating-ftp" class="table-of-contents__link toc-highlight"><strong>Enumerating FTP</strong></a></li><li><a href="#brute-forces--passwordusers-spray" class="table-of-contents__link toc-highlight"><strong>Brute Forces &amp; Password/Users Spray</strong></a></li></ul></li><li><a href="#winrm" class="table-of-contents__link toc-highlight"><strong>WinRM</strong></a><ul><li><a href="#identification--scan-2" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scan</strong></a></li><li><a href="#enumeration-winrm" class="table-of-contents__link toc-highlight"><strong>Enumeration WinRM</strong></a></li><li><a href="#brute-forces--passwordusers-spray-1" class="table-of-contents__link toc-highlight"><strong>Brute Forces &amp; Password/Users Spray</strong></a></li></ul></li><li><a href="#rdp" class="table-of-contents__link toc-highlight"><strong>RDP</strong></a><ul><li><a href="#identification-and-scans" class="table-of-contents__link toc-highlight"><strong>Identification and Scans</strong></a></li><li><a href="#enumeration-rdp" class="table-of-contents__link toc-highlight"><strong>Enumeration RDP</strong></a></li><li><a href="#brute-force--userspassword-spray" class="table-of-contents__link toc-highlight"><strong>Brute Force &amp; Users/Password Spray</strong></a></li><li><a href="#discovery" class="table-of-contents__link toc-highlight"><strong>Discovery</strong></a></li></ul></li><li><a href="#smtp" class="table-of-contents__link toc-highlight"><strong>SMTP</strong></a><ul><li><a href="#identification--scans" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scans</strong></a></li><li><a href="#enumeration-smtp" class="table-of-contents__link toc-highlight"><strong>Enumeration SMTP</strong></a></li><li><a href="#brute-force--usespassword-spray" class="table-of-contents__link toc-highlight"><strong>Brute Force &amp; Uses/Password Spray</strong></a></li><li><a href="#hydra-2" class="table-of-contents__link toc-highlight"><strong>Hydra</strong></a></li></ul></li><li><a href="#microsoft-sql-server-mssql" class="table-of-contents__link toc-highlight"><strong>Microsoft SQL Server (MSSQL)</strong></a><ul><li><a href="#identification--scans-1" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scans</strong></a></li><li><a href="#enumeration-mssql" class="table-of-contents__link toc-highlight"><strong>Enumeration MSSQL</strong></a></li><li><a href="#brute-force--usespassword-spray-1" class="table-of-contents__link toc-highlight"><strong>Brute Force &amp; Uses/Password Spray</strong></a></li></ul></li><li><a href="#mysql" class="table-of-contents__link toc-highlight"><strong>MySQL</strong></a><ul><li><a href="#identification--scans-2" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scans</strong></a></li><li><a href="#enumeration-mysql" class="table-of-contents__link toc-highlight"><strong>Enumeration MYSQL</strong></a></li><li><a href="#nse-nmap-5" class="table-of-contents__link toc-highlight"><strong>NSE Nmap</strong></a></li><li><a href="#brute-force--userspassword-spray-1" class="table-of-contents__link toc-highlight"><strong>Brute Force &amp; Users/Password Spray</strong></a></li><li><a href="#discovery-1" class="table-of-contents__link toc-highlight"><strong>Discovery</strong></a></li></ul></li><li><a href="#nfs" class="table-of-contents__link toc-highlight"><strong>NFS</strong></a><ul><li><a href="#identification--scans-3" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scans</strong></a></li><li><a href="#enumeration-nfs" class="table-of-contents__link toc-highlight"><strong>Enumeration NFS</strong></a></li><li><a href="#ssh-secure-shell" class="table-of-contents__link toc-highlight"><strong>SSH (Secure Shell)</strong></a></li><li><a href="#identification--scans-4" class="table-of-contents__link toc-highlight"><strong>Identification &amp; Scans</strong></a></li><li><a href="#enumeration-for-ssh" class="table-of-contents__link toc-highlight"><strong>Enumeration for SSH</strong></a></li><li><a href="#additional-information" class="table-of-contents__link toc-highlight">Additional Information</a></li><li><a href="#brute-force--userspassword-spray-2" class="table-of-contents__link toc-highlight"><strong>Brute Force &amp; Users/Password Spray</strong></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resume &amp; Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/journey/docs/Hasanresume">Hasan Resume</a></li><li class="footer__item"><a class="footer__link-item" href="/journey/docs/category/cybersecurity">CyberSecuritys</a></li></ul></div><div class="col footer__col"><div class="footer__title">Communitys</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.instagram.com/hasanrehni/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/hasan-rhani-767526210/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Hasan Rehni .</div></div></div></footer></div>
<script src="/journey/assets/js/runtime~main.c2615b4d.js"></script>
<script src="/journey/assets/js/main.c3ddc6cb.js"></script>
</body>
</html>